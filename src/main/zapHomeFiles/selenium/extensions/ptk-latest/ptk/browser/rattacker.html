<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
  <meta content="width=device-width, initial-scale=1, maximum-scale=2, user-scalable=no" name="viewport" />
  <meta content="Penetration Testing Kit - cross-browser extension for penetration testing" name="description" />
  <meta content="Penetration Testing Kit, request builder, traffic recording, macro recording" name="keywords" />
  <meta content="PPType" name="author" />
  <meta content="#ffffff" name="theme-color" />
  <title>OWASP Penetration Testing Kit - DAST (Dynamic Application Security Testing)</title>

  <script src="../packages/browser-polyfill/browser-polyfill.min.js"></script>
  <script src="../packages/jquery/jquery.min.js"></script>
  <script src="../packages/jquery/jquery.dataTables.min.js"></script>

  <link rel="stylesheet" href="../packages/semantic-ui/semantic.min.css" type="text/css" />
  <script src="../packages/semantic-ui/semantic.min.js"></script>

  <link rel="stylesheet" href="../packages/codemirror/codemirror.css" type="text/css" />
  <link rel="stylesheet" href="../packages/codemirror/addon/fold/foldgutter.css" type="text/css" />
  <script src="../packages/codemirror/codemirror.js"></script>
  <script src="../packages/codemirror/mode/http/http.js"></script>
  <script src="../packages/codemirror/addon/fold/foldcode.js"></script>
  <script src="../packages/codemirror/addon/fold/foldgutter.js"></script>
  <script src="../packages/codemirror/addon/fold/brace-fold.js"></script>
  <script src="../packages/codemirror/addon/fold/xml-fold.js"></script>
  <script src="../packages/codemirror/addon/fold/indent-fold.js"></script>
  <script src="../packages/codemirror/addon/fold/markdown-fold.js"></script>
  <script src="../packages/codemirror/addon/fold/comment-fold.js"></script>

  <link rel="stylesheet" href="assets/css/default.css" type="text/css" />
  <script src="assets/js/menu.js"></script>

  <script type="module" src="assets/js/rattacker.js"></script>

  <style>
    .CodeMirror-code {
      padding-top: 35px;
    }
  </style>

</head>

<body>
  <div class="ui segment clearing info_tab" >
    <div style="padding-top: 5px; padding-right: 4px;">
      <div class="ui small button generate_report" style="display: none;margin-left: -11px;">Generate
        report</div>
      <!-- <div class="ui small secondary button save_scan" style="display: none; position: relative">Save
          scan<i class="right floated cloud upload icon" style="padding-left: 8px;"></i>
          <div style="position:absolute; top:0px;right: 0px">
            <div class="ui  centered inline inverted loader"></div>
          </div>
        </div> -->

      <!-- <div class="ui small secondary button exchange" style="display: none; position: relative">
                    Import/Export<i class="right floated exchange icon" style="padding-left: 8px;"></i>
                    <div style="position:absolute; top:0px;right: 0px">
                        <div class="ui  centered inline inverted loader"></div>
                    </div>
                </div> -->

      <div class="ui mini message scan_info" style="display: none">
        <div class="ui header">Scanning <span id="scanning_url"></span></div>
      </div>
      <!-- <div class="ui mini right floated icon button " ><i class="settings rattacker large icon"
                    title="Settings"></i></div> -->
      <div class="ui mini right floated icon button"><i class="trash all alternate large icon reset" title="Reset"></i>
      </div>
      <!-- <div class="ui mini right floated icon button cloud_download_scans"><i class="cloud download alternate large icon" title="Download from cloud"></i>
        </div> -->
      <div class="ui mini right floated icon button import_export"><i class="exchange alternate large icon" title="Import/Export"></i>
      </div>

      <div class="ui secondary small right floated button run_scan_runtime" id="run_scan_bg_control">Scan in
        runtime</div>
      <div class="ui secondary small right floated button stop_scan_runtime" id="stop_scan_bg_control" style="display:none">Stop runtime scan</div>
    </div>
  </div>
  <div id="pagecontent">
    <div id="dast_page_loader" class="ui active inverted dimmer" style="display:block; position: fixed; top: 46px; left: 0; width: 100%; height: 100%; z-index: 2;">
      <div class="ui massive text loader">Loading</div>
    </div>

    <div id="main" style="display:none;height: 100%;height:100%;width: 100%;position: fixed; top: 46px;z-index: 1;">
      <table class="ui tiny table" style="padding: 0px;margin: 0px;border: none;height: 100%;">
        <tbody>
          <tr>
            <td style="min-width:50px; vertical-align: text-top; padding: 0px;">
              <div class="eight wide field" style="padding-right: 1px;height: 91vh;">
                <div class="field rattacker" style="scrollbar-width: none;height: 100% !important;min-height: 85vh; position: relative;">
                  <div class="field" style="border:none;scrollbar-width: none;position: absolute;height: 100%;width: 100%;">
                    <div class="ui items styled accordion" id="request_info" style="width: 100%; overflow: scroll;position:absolute; margin: 0px;scrollbar-width: none;">
                    </div>
                    <div style="position:absolute; top:0px;right: 0px">
                      <div class="ui centered inline active inverted loader" id="init_loader">
                      </div>
                    </div>


                    <div style="height: 60px; width: 50vw; position: fixed; bottom:0px; overflow: scroll;display:none;scrollbar-width: none;margin-left: -2px;" id="progress_message">
                      <div class="ui small message" style="height:100%">
                        <div class="header">
                          Scan progress
                        </div>
                        <p>Attack running: <span id="progress_attack_name"> </span></p>
                      </div>

                    </div>

                  </div>
                </div>
              </div>
            </td>
            <td style="width:50%;margin: 0px; padding: 0px 0px 0px 2px;border: none;vertical-align: top;">
              <div class="eight wide field" style="padding-left: 1px;height: 91vh;">
                <div class="field rattacker" style="scrollbar-width: none;height: 100% !important;min-height: 85vh;">
                  <div class="ui tiny message" style="position: sticky;top: 0px;z-index: 1; min-height: 80px;padding:0px">

                    <div class="ui compact active button" id="filter_all"><i class="icon" title="All attacks" style="min-width: 70px;">All attacks</i></div>
                    <div class="ui compact button" id="filter_vuln"><i class="icon" title="Vulnerabilities only" style="min-width: 70px;">Vulnerabilities</i>
                    </div>
                    <div class="ui compact button right floated" id="filter_500" style="right: 2px;"><i class="icon" title="500" style="min-width: 40px;">5xx</i>
                    </div>
                    <div class="ui compact button right floated" id="filter_400" style="right: 64px;"><i class="icon" title="500" style="min-width: 40px;">4xx</i>
                    </div>
                    <br />
                    <div class="ui mini statistics ptk-summary-stats" style="margin-top:5px;margin-left:5px;display: inline-block;">
                      <div class="statistic">
                        <div class="label">Attacks</div>
                        <div class="value" id="dast_attacks_count">0</div>
                      </div>
                      <div class="statistic">
                        <div class="label">Findings</div>
                        <div class="value" id="dast_vulns_count">0</div>
                      </div>
                    </div>
                    <div class="ui mini statistics ptk-severity-stats" style="margin-top:5px;display: inline-block; position: absolute;right: 20px;">
                      <div class="statistic">
                        <div class="label"><i class="fire ptk-sev-critical icon"></i>Critical</div>
                        <div class="value" id="dast_critical_count">0</div>
                      </div>
                      <div class="statistic">
                        <div class="label"><i class="exclamation triangle ptk-sev-high icon"></i>High</div>
                        <div class="value" id="dast_high_count">0</div>
                      </div>
                      <div class="statistic">
                        <div class="label"><i class="exclamation triangle ptk-sev-medium icon"></i>Medium</div>
                        <div class="value" id="dast_medium_count">0</div>
                      </div>
                      <div class="statistic">
                        <div class="label"><i class="exclamation triangle ptk-sev-low icon"></i>Low</div>
                        <div class="value" id="dast_low_count">0</div>
                      </div>
                      <div class="statistic">
                        <div class="label"><i class="info circle ptk-sev-info icon"></i>Info</div>
                        <div class="value" id="dast_info_count">0</div>
                      </div>
                    </div>
                  </div>
                  <div class="ui items" id="attacks_info" style="width: 100%; overflow: scroll;position:absolute; margin: 0px;scrollbar-width: none;">
                  </div>

                </div>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div id="welcome_message" class="ptk-welcome" style="display:none;">
      <div class="ui message ptk-welcome-msg">
        <div class="ptk-welcome-top">
          <div class="content ptk-welcome-desc">
            DAST, or Dynamic Application Security Testing, is a security testing method that analyzes a
            running application by simulating real-world attacks to identify vulnerabilities, much like a
            penetration tester.
          </div>

          <div class="header">How to scan an application:</div>

          <div class="content ptk-welcome-steps">
            <ul>
              <li>Click the "Scan in runtime" button and confirm it's starting</li>
              <li>Start browsing the application you are scanning (click links, submit forms, etc.)</li>
              <li>Once completed open DAST scanner (R-Attacker) and stop the scan</li>
              <li>Check the result</li>
            </ul>
          </div>
        </div>

        <!-- Scroll area -->
        <div class="ptk-welcome-tablewrap" style="scrollbar-width: none;">
          <table id="tbl_modules" class="ui celled table small nowrap unstackable" width="100%">
            <thead>
              <tr>
                <th style="width:45%;">Module</th>
                <th style="width:25%;">Number of attacks</th>
                <th style="width:30%;">Severity</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>

  </div>

  <!-- Attack details and showHtml support -->
  <div id="attack_details_dialog_wrapper"></div>

  <div class="ui mini modal coupled error" id="result_dialog">
    <div class="header" id="result_header"></div>
    <div class="content">
      <span id="result_message"></span>
    </div>
    <div class="actions">
      <div class="ui approve button">Close</div>
    </div>
  </div>

  <div id="download_scans" class="ui fullscreen modal coupled first" style="display: none; height: 83%">
    <i class="close icon"></i>
    <div class="ui small header">Scans:</div>
    <div class="content" style="min-height: 400px; overflow: scroll;height: 90%;scrollbar-width: none;">
      <div class="ui negative message" id="download_scans_error" style="height: 100px;overflow: scroll;display: none;scrollbar-width: none;">
        <div class="header">
          Error
        </div>
        <p id="download_error"></p>
        <p>Check you API key. Open <i class="question circle outline large icon"></i>Settings -> <i class="cloud large icon"></i>PTK+ and make sure you have provided a valid key</p>
      </div>
      <form class="ui tiny form controls" id="scan_list">
        <div class="field" style="max-width: 320px;">
          <label>Select project</label>
          <select class="ui dropdown" id="download_project_select">
            <option value="">Select a project</option>
          </select>
        </div>

        <table id="tbl_scans" class="ui celled table small responsive nowrap unstackable" width="100%" style="margin-bottom: 104px;">
          <thead>
            <tr>
              <th>Domain</th>
              <th>Scan ID</th>
              <th>Scan date</th>
              <th>Download</th>
              <th>Delete</th>
            </tr>
          </thead>
        </table>
      </form>
    </div>
  </div>

  <div id="delete_scan_dlg" class="ui mini modal coupled second" style="display: none;">
    <i class="close icon"></i>
    <div class="ui header">Confirm delete</div>
    <div class="content">
      <span id="scan_delete_message"></span>
      <form class="ui tiny form controls" id="scan_delete_form">
        <input type="text" id="scan_hostname" placeholder="Type scan hostname">
      </form>
    </div>

    <div class="actions">
      <div class="ui approve button secondary confirm_scan_delete">Delete scan</div>
    </div>
  </div>

  <div id="save_scan_modal" class="ui small modal coupled second" style="display: none;">
    <i class="close icon"></i>
    <div class="ui header">Select project</div>
    <div class="content">
      <form class="ui small form">
        <div class="field">
          <label>Portal project</label>
          <select class="ui dropdown" id="save_scan_project_select">
            <option value="">Select a project</option>
          </select>
        </div>
        <div class="ui tiny negative message" id="save_scan_modal_error" style="display: none;"></div>
      </form>
    </div>
    <div class="actions">
      <div class="ui button cancel">Cancel</div>
      <div class="ui primary button approve">Save scan</div>
    </div>
  </div>

  <div id="run_scan_dlg" class="ui fullscreen modal coupled second" style="display: none;">
    <i class="close icon"></i>
    <div class="header">Confirm scan execution</div>

    <div class="content">
      <div class="ui message" style="margin: -20px -20px 0px -20px;">
        <p>Are you sure you want to run DAST scan against <span id="scan_host" style="font-weight: 600;"></span>?</p>
      </div>
      <div id="ptk_scan_reload_warning" class="ui warning message ptk-reload-warning ptk-reload-warning-dast">
        <i id="ptk_scan_reload_warning_close_dast" class="close icon"></i>
        Reload this tab to enable runtime scans (IAST/SAST). DAST can still run.
      </div>
      <br />
      <form class="ui small form" id="dast_form">
        <div class="ui sixteen column width grid">
          <div class="row" style="border-bottom: solid 1px #cecece;">
            <div class="six wide column">
              <div class="field">
                <label>Domains to scan (comma separated):</label>
                <i class="domains_example question circle icon" style='cursor:pointer;position: absolute;top:0px;right: 0px;'></i>
                <div class="ui fluid popup bottom left transition hidden" style="min-width: 350px;">
                  <strong>Example:</strong> <br />
                  <i>domain.com, api.domain.com, subdomain.domain.com, www.domain.com</i>
                  <br />
                  <b>OR</b>
                  <br />
                  <i>*.domain.com - to scan all subdomains</i>
                </div>
                <textarea id="scan_domains" style="width: 100%; min-height: 50px;height: 105px;"></textarea>
              </div>
            </div>
            <div class="six wide column">
              <div class="field">
                <label>Scan strategy:</label>
                <i class="question circle icon" style='cursor:pointer;position: absolute;top:0px;right: 0px;'></i>
                <div class="ui fluid popup bottom right transition hidden" style="min-width: 350px;margin-left: 200px;">
                  <strong>Strategy:</strong> <br />
                  <ul>
                    <li>Fast – attack all params in one request, stop after first finding per module/URL</li>
                    <li>Smart (recommended) – one param per request, stop after first finding per module/param</li>
                    <li>Comprehensive – one param per request, report all findings</li>
                  </ul>
                </div>
                <select id="dast-scan-strategy" name="dastScanStrategy" class="ui dropdown" style="width: 100%;">
                  <option value="FAST">Fast</option>
                  <option value="SMART" selected>Smart (recommended)</option>
                  <option value="COMPREHENSIVE">Comprehensive</option>
                </select>
              </div>
              <div class="field">
                <label>Scan policy:</label>
                <i class="question circle icon" style='cursor:pointer;position: absolute;top:70px;right: 0px;'></i>
                <div class="ui fluid popup bottom right transition hidden" style="min-width: 350px;margin-left: 100px;">
                  <strong>Scan policy:</strong> <br />
                  <i><b>Reconnaissance</b> is the safest default. It focuses on discovery (URLs, parameters, tech signals, passive checks) with a minimal footprint. <b>Active</b> runs exploit-style tests and can generate a lot more requests — use it only when you have permission and the target can handle it.</i>
                  <ul>
                    <li><b>Reconnaissance</b> if you’re exploring a new target, doing bug bounty recon, or scanning “live” production apps and want low noise</li>
                    <li><b>Active</b> for dev/test environments, dedicated staging, or authorized pentests where you want to validate real vulnerabilities</li>
                  </ul>
                </div>
                <select id="dast-scan-policy" name="dastScanPolicy" class="ui dropdown" style="width: 100%;">
                  <option value="RECON">Reconnaissance</option>
                  <option value="ACTIVE" selected>Active</option>
                </select>
              </div>
            </div>
          </div>
          <div class="row" style="border-bottom: solid 1px #cecece;">
            <div class="three wide column">
              <div class="field">
                <label>Concurrency:</label>
                <i class="question circle icon" style='cursor:pointer;position: absolute;top:0px;left: 90px;'></i>
                <div class="ui fluid popup bottom left transition hidden" style="min-width: 350px;">
                  <strong>Concurrency:</strong> <br />
                  <i>1-3 is a safe range. Never more than 5, unless you’re doing very short requests and you control the target</i>
                  <ul>
                    <li>1 (sequential) if you want minimal footprint or are scanning “live” apps</li>
                    <li>2 for reasonable speed without overloading a single tab/session</li>
                    <li>3-4 for dev/test where performance matters more than stealth</li>
                  </ul>
                </div>
                <div class="ui toggle text" style="width: 50px;">
                  <input type="text" id="concurrency" name="concurrency">
                </div>
              </div>
            </div>
            <div class="five wide column">
              <div class="field">
                <label>Attack requests per second:</label>
                <i class="request_per_second_example question circle icon" style='cursor:pointer;position: absolute;top:0px;left: 165px;'></i>
                <div class="ui fluid popup bottom left transition hidden" style="min-width: 350px;">
                  <strong>Attack requests per second:</strong> <br />
                  <i>5-10 requests/second is a safe default for most websites, especially for active scanning (SQLi, XSS, etc.).</i>
                  <br />
                  <ul>
                    <li>5 if you want to be extra gentle, minimize detection, or scan “production” apps</li>
                    <li>10 if you know the site can take some load or it’s a dev/test environment</li>
                    <li>2-3 for critical production, very slow or fragile sites, or to fly under the radar</li>
                  </ul>
                </div>
                <div class="ui toggle text" style="width: 50px;">
                  <input type="text" id="maxRequestsPerSecond" name="maxRequestsPerSecond">
                </div>
              </div>
            </div>
            <div class="five wide column">
              <div class="field">
                <i class="cve_example question circle icon" style='cursor:pointer;position: absolute;top:0px;left: 180px;'></i>
                <div class="ui fluid popup top right transition hidden" style="min-width: 250px;">
                  <strong>CVE-specific attacks:</strong> <br />
                  May trigger 5xx errors or crashes on vulnerable endpoints. Only use on systems you own.
                </div>
                <label>Run CVE checks (danger zone):</label>
                <div class="ui checkbox">
                  <input type="checkbox" id="ptk_dast_run_cve">
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>

    </div>
    <div class="actions">
      <div class="ui cancel button">Cancel</div>
      <div class="ui approve button secondary confirm_scan_run">Run scan</div>
    </div>
  </div>



  <div id="import_export_dlg" class="ui fullscreen modal coupled second" style="display: none;">
    <i class="close icon"></i>
    <div class="ui header">Import/Export</div>
    <div class="content">
      <div class="ui  button secondary export_scan_btn">Export</div>
    </div>
    <div class="ui horizontal divider">
      Or
    </div>
    <div class="content">

      <form class="ui tiny form controls" id="scan_delete_form">
        <textarea id="import_scan_json" style="width: 100%; min-height: 100px;"></textarea>
      </form>
      <div class="ui  button secondary import_scan_text_btn">Import from text</div>
      <div class="ui right floated button secondary import_scan_file_btn">Import from file</div>
      <input id="import_scan_file_input" type="file" hidden />
    </div>
  </div>

</body>

</html>
