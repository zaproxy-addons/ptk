<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
  <meta content="width=device-width, initial-scale=1, maximum-scale=2, user-scalable=no" name="viewport" />
  <meta content="Penetration Testing Kit - cross-browser extension for penetration testing" name="description" />
  <meta content="Penetration Testing Kit, request builder, traffic recording, macro recording" name="keywords" />
  <meta content="PPType" name="author" />
  <meta content="#ffffff" name="theme-color" />
  <title>OWASP Penetration Testing Kit - SAST (Static Application Security Testing)</title>

  <script src="../packages/browser-polyfill/browser-polyfill.min.js"></script>
  <script src="../packages/jquery/jquery.min.js"></script>
  <script src="../packages/jquery/jquery.dataTables.min.js"></script>

  <link rel="stylesheet" href="../packages/semantic-ui/semantic.min.css" type="text/css" />
  <script src="../packages/semantic-ui/semantic.min.js"></script>

  <link rel="stylesheet" href="../packages/codemirror/codemirror.css" type="text/css" />
  <link rel="stylesheet" href="../packages/codemirror/addon/fold/foldgutter.css" type="text/css" />
  <script src="../packages/codemirror/codemirror.js"></script>
  <script src="../packages/codemirror/mode/http/http.js"></script>
  <script src="../packages/codemirror/addon/fold/foldcode.js"></script>
  <script src="../packages/codemirror/addon/fold/foldgutter.js"></script>
  <script src="../packages/codemirror/addon/fold/brace-fold.js"></script>
  <script src="../packages/codemirror/addon/fold/xml-fold.js"></script>
  <script src="../packages/codemirror/addon/fold/indent-fold.js"></script>
  <script src="../packages/codemirror/addon/fold/markdown-fold.js"></script>
  <script src="../packages/codemirror/addon/fold/comment-fold.js"></script>

  <link rel="stylesheet" href="assets/css/default.css" type="text/css" />
  <script src="assets/js/menu.js"></script>

  <script type="module" src="assets/js/sast.js"></script>

  <style>
    .CodeMirror-code {
      padding-top: 35px;
    }
  </style>

</head>

<body>
  <div class="ui segment clearing info_tab">
    <div style="padding-top: 5px; padding-right: 4px;">
      <div class="ui small button generate_report" style="display: none;margin-left: -11px;">Generate
        report</div>
      <!-- <div class="ui small secondary button save_scan" style="display: none; position: relative">Save
        scan<i class="right floated cloud upload icon" style="padding-left: 8px;"></i>
        <div style="position:absolute; top:0px;right: 0px">
          <div class="ui  centered inline inverted loader"></div>
        </div>
      </div> -->

      <!-- <div class="ui small secondary button exchange" style="display: none; position: relative">
                  Import/Export<i class="right floated exchange icon" style="padding-left: 8px;"></i>
                  <div style="position:absolute; top:0px;right: 0px">
                      <div class="ui  centered inline inverted loader"></div>
                  </div>
              </div> -->

      <div class="ui mini message scan_info" style="display: none">
        <div class="ui header">Scanning <span id="scanning_url"></span></div>
      </div>
      <!-- <div class="ui mini right floated icon button " ><i class="settings rattacker large icon"
                  title="Settings"></i></div> -->
      <div class="ui mini right floated icon button"><i class="trash all alternate large icon reset" title="Reset"></i>
      </div>
      <!-- <div class="ui mini right floated icon button cloud_download_scans"><i class="cloud download alternate large icon" title="Download from cloud"></i>
      </div> -->
      <div class="ui mini right floated icon button import_export"><i class="exchange alternate large icon" title="Import/Export"></i>
      </div>

      <div class="ui secondary small right floated button run_scan_runtime" id="run_scan_bg_control">Scan in
        runtime</div>
      <div class="ui secondary small right floated button stop_scan_runtime" id="stop_scan_bg_control" style="display:none">Stop runtime scan</div>
    </div>
  </div>
  <div id="pagecontent">
    <div id="sast_page_loader" class="ui active inverted dimmer" style="display:block; position: fixed; top: 46px; left: 0; width: 100%; height: 100%; z-index: 2;">
      <div class="ui massive text loader">Loading</div>
    </div>
    <div id="main" style="display:none;height: 100%;height:100%;width: 100%;position: fixed; top: 46px;z-index: 1;">
      <table class="ui tiny table" style="padding: 0px;margin: 0px;border: none;height: 100%;">
        <tbody>
          <tr>
            <td style="min-width:50px; vertical-align: text-top; padding: 0px;">
              <div class="eight wide field" style="padding-right: 1px;height: 91vh;">
                <div class="field rattacker" style="scrollbar-width: none;height: 100% !important;min-height: 85vh; position: relative;">
                  <div class="field" style="border:none;scrollbar-width: none;position: absolute;height: 100%;width: 100%;">
                    <div class="ui items styled accordion" id="request_info" style="width: 100%; overflow: scroll;position:absolute; margin: 0px;scrollbar-width: none;">
                    </div>
                    <div style="position:absolute; top:0px;right: 0px">
                      <div class="ui centered inline active inverted loader" id="init_loader">
                      </div>
                    </div>


                    <div style="height: 60px; width: 50vw; position: fixed; bottom:0px; overflow: scroll;display:none;scrollbar-width: none;margin-left: -2px;" id="progress_message">
                      <div class="ui small message" style="height:100%">
                        <div class="header">
                          Scan progress
                        </div>
                        <p>Rule running: <span id="progress_attack_name"> </span></p>
                      </div>

                    </div>

                  </div>
                </div>
              </div>
            </td>
            <td style="width:50%;margin: 0px; padding: 0px 0px 0px 2px;border: none;vertical-align: top;">
              <div class="eight wide field" style="padding-left: 1px;height: 91vh;">
                <div class="field rattacker" style="scrollbar-width: none;height: 100% !important;min-height: 85vh;">
                  <div class="ui tiny message" style="position: sticky;top: 0px;z-index: 1; min-height: 80px;padding:0px">
                    <div class="ui small icon buttons" style="position: absolute;top: 0px;left: 0px;width: 100%;">

                      <div class="field" style="width: 100%;">
                        <div class="ui fluid tiny  dropdown icon button" id="rule_filter_dropdown" style="width: 100%;">
                          <div class="text">Filter by rule</div>
                          <i class="dropdown icon"></i>
                          <input type="hidden" value="__sast_all_rules__">
                          <div class="menu">
                            <div class="item active selected" data-value="__sast_all_rules__">All rules</div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <br />
                    <div class="ui mini statistics ptk-summary-stats" style="margin-top: 20px; display: inline-block;position: absolute;left: 20px;">
                      <div class="statistic">
                        <div class="label">Rules</div>
                        <div class="value" id="sast_attacks_count">0</div>
                      </div>
                      <div class="statistic" style="padding-left: 10px;">
                        <div class="label">Findings</div>
                        <div class="value" id="sast_vulns_count">0</div>
                      </div>
                    </div>

                    <div class="ui mini statistics ptk-severity-stats" style="margin-top:20px;display: inline-block; position: absolute;right: 20px;">
                      <div class="statistic">
                        <div class="label"><i class="fire ptk-sev-critical icon"></i>Critical</div>
                        <div class="value" id="sast_critical_count">0</div>
                      </div>
                      <div class="statistic">
                        <div class="label"><i class="exclamation triangle ptk-sev-high icon"></i>High</div>
                        <div class="value" id="sast_high_count">0</div>
                      </div>
                      <div class="statistic">
                        <div class="label"><i class="exclamation triangle ptk-sev-medium icon"></i>Medium</div>
                        <div class="value" id="sast_medium_count">0</div>
                      </div>
                      <div class="statistic">
                        <div class="label"><i class="exclamation triangle ptk-sev-low icon"></i>Low</div>
                        <div class="value" id="sast_low_count">0</div>
                      </div>
                      <div class="statistic">
                        <div class="label"><i class="info circle ptk-sev-info icon"></i>Info</div>
                        <div class="value" id="sast_info_count">0</div>
                      </div>
                    </div>
                  </div>
                  <div class="ui items" id="attacks_info" style="width: 100%; overflow: scroll;position:absolute; margin: 0px;scrollbar-width: none;">
                  </div>

                </div>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
      <!--
            <div class="eight wide field" style="padding-left: 1px;">
                <div class="field rattacker" style="scrollbar-width: none;height: 100% !important;min-height: 85vh;">
                    <div class="ui tiny message"
                        style="position: sticky;top: 0px;z-index: 1; min-height: 80px;padding-top:15px">

                        <div class="ui mini statistic left floated" style="margin-top: 5px;">
                            <div class="label">
                                Findings
                            </div>
                            <div class="value" id="sast_vulns_count">
                                0
                            </div>

                        </div>
                        <div class="ui mini statistic right floated" style="margin-top: 5px;">
                            <div class="label"><i class="info circle ptk-sev-info icon"></i>
                                Info
                            </div>
                            <div class="value" id="sast_info_count">
                                0
                            </div>
                        </div>
                        <div class="ui mini statistic right floated" style="margin-top: 5px;">
                            <div class="label"><i class="exclamation triangle ptk-sev-low icon"></i>
                                Low
                            </div>
                            <div class="value" id="sast_low_count">
                                0
                            </div>
                        </div>
                        <div class="ui mini statistic right floated" style="margin-top: 5px;">
                            <div class="label"><i class="exclamation triangle ptk-sev-medium icon"></i>
                                Medium
                            </div>
                            <div class="value" id="sast_medium_count">
                                0
                            </div>
                        </div>
                        <div class="ui mini statistic right floated" style="margin-top: 5px;">
                            <div class="label"><i class="exclamation triangle ptk-sev-high icon"></i>
                                High
                            </div>
                            <div class="value" id="sast_high_count">
                                0
                            </div>
                        </div>
                        <div class="ui mini statistic right floated" style="margin-top: 5px;">
                            <div class="label"><i class="fire ptk-sev-critical icon"></i>
                                Critical
                            </div>
                            <div class="value" id="sast_critical_count">
                                0
                            </div>
                        </div>
                    </div>
                    <div class="ui cards" id="attacks_info"
                        style="width: 100%; overflow: scroll;position:absolute; margin: 0px;scrollbar-width: none;">
                    </div>

                </div>
            </div>
-->

    </div>

  </div>

  <div id="welcome_message" class="ptk-welcome" style="display:none;">
    <div class="ui message ptk-welcome-msg">
      <div class="ptk-welcome-top">
        <div class="content ptk-welcome-desc">
          SAST, or Static Application Security Testing, is a white-box testing method that analyzes source code, bytecode, or binary code for vulnerabilities without executing the application. By scanning JS source files (including ES modules, frameworks like React/Vue, and embedded scripts in HTML), OWASP PTK will identify injection flaws, insecure data handling and DOM-based XSS before code ever reaches QA or production.
        </div>
        <div class="header">How to scan an application:</div>
        <div class="content ptk-welcome-steps">
          <ul>
            <li>Click the "Scan in runtime" button and confirm it's starting</li>
            <li>Start browsing the application you are scanning, e.g. click on different links, submit forms, etc.</li>
            <li>Once completed open SAST scanner and stop the scan</li>
            <li>Check the result</li>
          </ul>
        </div>
      </div>
      <div class="ptk-welcome-tablewrap" style="scrollbar-width: none;">
        <table id="sast_rules_table" class="ui celled table small responsive nowrap unstackable" width="100%">
          <thead>
            <tr>
              <th style="width: 50%;">Rule</th>
              <th style="width: 35%;">Module</th>
              <th style="width: 15%;">Severity</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Attack details and showHtml support -->
  <div id="attack_details_dialog_wrapper"></div>

  <div class="ui mini modal coupled error" id="result_dialog">
    <div class="header" id="result_header"></div>
    <div class="content">
      <span id="result_message"></span>
    </div>
    <div class="actions">
      <div class="ui approve button">Close</div>
    </div>
  </div>

  <div id="download_scans" class="ui fullscreen modal coupled first" style="display: none; height: 83%">
    <i class="close icon"></i>
    <div class="ui small header">Scans:</div>
    <div class="content" style="min-height: 400px; overflow: scroll;height: 90%;scrollbar-width: none;">
      <div class="ui negative message" id="download_scans_error" style="height: 100px;overflow: scroll;display: none;scrollbar-width: none;">
        <div class="header">
          Error
        </div>
        <p id="download_error"></p>
        <p>Check you API key. Open <i class="question circle outline large icon"></i>Settings -> <i class="cloud large icon"></i>PTK+ and make sure you have provided a valid key</p>
      </div>
      <form class="ui tiny form controls" id="scan_list">
        <div class="field" style="max-width: 320px;">
          <label>Select project</label>
          <select class="ui dropdown" id="download_project_select">
            <option value="">Select a project</option>
          </select>
        </div>

        <table id="tbl_scans" class="ui celled table small responsive nowrap unstackable" width="100%" style="margin-bottom: 104px;">
          <thead>
            <tr>
              <th>Domain</th>
              <th>Scan ID</th>
              <th>Scan date</th>
              <th>Download</th>
              <th>Delete</th>
            </tr>
          </thead>
        </table>
      </form>
    </div>
  </div>

  <div id="delete_scan_dlg" class="ui mini modal coupled second" style="display: none;">
    <i class="close icon"></i>
    <div class="ui header">Confirm delete</div>
    <div class="content">
      <span id="scan_delete_message"></span>
      <form class="ui tiny form controls" id="scan_delete_form">
        <input type="text" id="scan_hostname" placeholder="Type scan hostname">
      </form>
    </div>

    <div class="actions">
      <div class="ui approve button secondary confirm_scan_delete">Delete scan</div>
    </div>
  </div>

  <div id="sast_save_scan_modal" class="ui small modal coupled second" style="display: none;">
    <i class="close icon"></i>
    <div class="ui header">Select project</div>
    <div class="content">
      <form class="ui small form">
        <div class="field">
          <label>Portal project</label>
          <select class="ui dropdown" id="sast_save_scan_project_select">
            <option value="">Select a project</option>
          </select>
        </div>
        <div class="ui tiny negative message" id="sast_save_scan_modal_error" style="display: none;"></div>
      </form>
    </div>
    <div class="actions">
      <div class="ui button cancel">Cancel</div>
      <div class="ui primary button approve">Save scan</div>
    </div>
  </div>

  <div id="run_scan_dlg" class="ui small modal coupled second" style="display: none;">
    <i class="close icon"></i>
    <div class="header">Confirm scan execution</div>

    <div class="content">
      <div class="ui message" style="margin: -20px -20px 0px -20px;">
        <p>Are you sure you want to run SAST scan against <span id="scan_host" style="font-weight: 600;"></span>?</p>
      </div>
      <div id="ptk_scan_reload_warning" class="ui warning message ptk-reload-warning ptk-reload-warning-sast">
        <i id="ptk_scan_reload_warning_close_sast" class="close icon"></i>
        Reload this tab to enable runtime signals required for SAST.
      </div>
      <div class="ui form" id="sast_scans_form" style="margin-top: 12px;">
        <div class="field">
          <label>Scan strategy:</label>
          <i class="question circle icon" style='cursor:pointer;position: absolute;top:0px;left: 85px;'></i>
          <div class="ui fluid popup bottom right transition hidden" style="min-width: 350px;">
            <strong>Scan strategy:</strong> <br />
            <ul>
              <li>All rules (recommended) – run both taint-flow and pattern rules.</li>
              <li>Taint flow – only taint-based rules (faster, fewer findings).</li>
            </ul>
          </div>
          <select id="sast-scan-strategy" class="ui dropdown" style="width: 100%;">
            <option value="0">All rules (recommended)</option>
            <option value="1">Taint flow rules</option>
          </select>
        </div>
      </div>

    </div>
    <!-- 
    <div class="ui fluid selection dropdown">
      <input type="hidden" name="scanStrategy" id="sast-scan-strategy">
      <i class="dropdown icon"></i>
      <div class="default text">Scan strategy</div>
      <div class="menu">
        <div class="item" data-value="0">All rules</div>
        <div class="item" data-value="1">Taint flow rules</div>
      </div>
    </div>
    <div class="ui form" style="margin-top: 12px;">
      <div class="field">
        <label>Pages to analyze (comma or newline separated)</label>
        <textarea id="sast_pages" rows="3" placeholder="http://localhost:3001/#/search?q=test"></textarea>
      </div>
    </div> -->
    <br />
    <div class="actions">
      <div class="ui cancel button">Cancel</div>
      <div class="ui approve button secondary confirm_scan_run">Run scan</div>
    </div>
  </div>



  <div id="import_export_dlg" class="ui fullscreen modal coupled second" style="display: none;">
    <i class="close icon"></i>
    <div class="ui header">Import/Export</div>
    <div class="content">
      <div class="ui  button secondary export_scan_btn">Export</div>
    </div>
    <div class="ui horizontal divider">
      Or
    </div>
    <div class="content">

      <form class="ui tiny form controls" id="scan_delete_form">
        <textarea id="import_scan_json" style="width: 100%; min-height: 100px;"></textarea>
      </form>
      <div class="ui  button secondary import_scan_text_btn">Import from text</div>
      <div class="ui right floated button secondary import_scan_file_btn">Import from file</div>
      <input id="import_scan_file_input" type="file" hidden />
      <div class="ui message error" id="scan_import_error_msg" style="display: none;"></div>
    </div>
  </div>


</body>

</html>
