{
  "schema": "ptk-modules-v1",
  "engine": "DAST",
  "version": 1,
  "modules": [
    {
      "id": "sql_injection",
      "type": "active",
      "async": true,
      "name": "SQL Injection",
      "metadata": {
        "description": "A SQL injection attack consists of insertion or injection of a SQL query via the input data from the client to the application. A successful SQL injection exploit can read sensitive data from the database, modify database data (Insert/Update/Delete), execute administration operations on the database (such as shutdown the DBMS), recover the content of a given file present on the DBMS file system and in some cases issue commands to the operating system. SQL injection attacks are a type of injection attack, in which SQL commands are injected into data-plane input in order to affect the execution of predefined SQL commands.",
        "recommendation": "<p> <a target=\"_blank\" href=\"https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet\"> SQL Injection</a> flaws are introduced when software developers create dynamic database queries that include user supplied input.\r\n<p>\r\nPrimary Defenses:\r\n<ul>\r\n<li>Use of Prepared Statements (Parameterized Queries)<p>\r\nParameterized queries force the developer to first define all the SQL code, and then pass in each parameter to the query later. This coding style allows the database to distinguish between code and data, regardless of what user input is supplied.\r\n\r\nPrepared statements ensure that an attacker is not able to change the intent of a query, even if SQL commands are inserted by an attacker.\r\n\r\n<li>Use of Stored Procedures<p>\r\n\r\nStored procedures have the same effect as the use of prepared statements when implemented safely* which is the norm for most stored procedure languages. They require the developer to just build SQL statements with parameters which are automatically parameterized unless the developer does something largely out of the norm. The difference between prepared statements and stored procedures is that the SQL code for a stored procedure is defined and stored in the database itself, and then called from the application. Both of these techniques have the same effectiveness in preventing SQL injection so your organization should choose which approach makes the most sense for you.\r\n\r\n<li>Escaping all User Supplied Input<p>\r\n\r\nThis technique is to escape user input before putting it in a query. However, this methodology is frail compared to using parameterized queries and we cannot guarantee it will prevent all SQL Injection in all situations. This technique should only be used, with caution, to retrofit legacy code in a cost effective way. Applications built from scratch, or applications requiring low risk tolerance should be built or re-written using parameterized queries.<p>\r\nEach DBMS supports one or more character escaping schemes specific to certain kinds of queries. If you then escape all user supplied input using the proper escaping scheme for the database you are using, the DBMS will not confuse that input with SQL code written by the developer, thus avoiding any possible SQL injection vulnerabilities.\r\n\r\nFull details on <a target=\"_blank\" href=\"https://www.owasp.org/index.php/ESAPI\">ESAPI are available at OWASP.</a>\r\n\r\n</ul>\r\nAdditional Defenses:\r\n<ul>\r\n<li>Least Privilege<p>\r\n\r\nTo minimize the potential damage of a successful SQL injection attack, you should minimize the privileges assigned to every database account in your environment. Do not assign DBA or admin type access rights to your application accounts. We understand that this is easy, and everything just 'works' when you do it this way, but it is very dangerous. Start from the ground up to determine what access rights your application accounts require, rather than trying to figure out what access rights you need to take away. Make sure that accounts that only need read access are only granted read access to the tables they need access to. If an account only needs access to portions of a table, consider creating a view that limits access to that portion of the data and assigning the account access to the view instead, rather than the underlying table. Rarely, if ever, grant create or delete access to database accounts.\r\n\r\n<li>Allow List Input Validation<p>\r\nInput validation can be used to detect unauthorized input before it is passed to the SQL query. For more information please see the <a target=\"_blank\" href=\"https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet\">OWASP Input Validation Cheat Sheet</a>. Proceed with caution here. Validated data is not necessarily safe to insert into SQL queries via string building. \r\n</ul>\r\n</li>\r\n</ul>",
        "links": {
          "OWASP": "https://owasp.org/www-community/attacks/SQL_Injection",
          "CWE": "https://cwe.mitre.org/data/definitions/89.html"
        },
        "severity": "high",
        "unique": true,
        "regex": "(\\]\\[(DB2|ODBC|OleDb|Oracle|SqlServer|MySQL)|mysqli?_fetch_|not a valid MySQL|not a legal PLSQL identifer|mysqli?_connect\\(\\)|(SELECT\\s+[^:>]+\\sFROM\\s+[^:>]+\\sWHERE\\s+)|(at\\s[[:alnum:]\\\\/\\._]+\\sline\\s\\d+)|ociparse\\(\\):|must be a syntactically valid variable|CFSQLTYPE|Unknown column ['`]|Microsoft OLE DB Provider for SQL|SQL QUERY FAILURE:|Syntax error.{1,50}in query|ORA-01722:|PostgreSQL query failed:|nested\\s+exception\\s+is\\s+com.microsoft.sqlserver.jdbc.SQLServerException|Could\\s+not\\s+find\\s+stored\\s+procedure|uncategorized\\s+SQLException\\s+for\\s+SQL|You\\s+have\\s+an\\s+error\\s+in\\s+your\\s+SQL\\s+syntax|Unclosed\\s+quotation\\s+mark|(quoted|terminated)[ \r\n]+.{1,100}(quoted|terminated)|sql syntax error|Syntax\\s+error\\s+in\\s+string\\s+in\\s+query\\s+expression\\s+column|Syntax error.{1,50}column|java\\.sql\\.SQLSyntaxErrorException|dao\\.EmptyResultDataAccessException|System\\.Data\\.OleDb\\.OleDbException|insert\\s+into\\s+['`][^\\s]+|database\\s+error|dberror|SqlClient.SqlException).{0,70}|call[ ]+to[ ]+a[ ]+member[ ]+function[ ]+fetch_assoc\\(\\)[ ]+.{0,100}|All[ ]+queries[ ]+combined[ ]+using[ ]+a[ ]+UNION,[ ]+INTERSECT[ ]+or[ ]+EXCEPT.{0,70}|(SQLITE_|sqlite3\\.Operational)ERROR.{0,70}",
        "category": "injection",
        "owasp": ["A05:2025 - Injection", "A03:2021 - Injection"],
        "cwe": ["CWE-89"],
        "tags": ["dast", "injection", "sql"],
        "vulnId": "sql_injection"
      },
      "attacks": [
        {
          "id": "sqlinjection_1",
          "name": "SQL Injection - Single Quote (before)",
          "action": {
            "params": [
              {
                "value": "'",
                "position": "before",
                "operation": "add"
              }
            ]
          },
          "validation": {
            "rule": {
              "regex": [
                {
                  "var": "attack.response.body"
                },
                {
                  "var": "attack.metadata.regex"
                }
              ]
            },
            "proof": {
              "proof": [
                {
                  "var": "attack.response.body"
                },
                {
                  "var": "attack.metadata.regex"
                }
              ]
            }
          }
        },
        {
          "id": "sqlinjection_3",
          "name": "SQL Injection - Double Quote (before)",
          "action": {
            "params": [
              {
                "value": "\"",
                "position": "before",
                "operation": "add"
              }
            ]
          },
          "validation": {
            "rule": {
              "regex": [
                {
                  "var": "attack.response.body"
                },
                {
                  "var": "attack.metadata.regex"
                }
              ]
            },
            "proof": {
              "proof": [
                {
                  "var": "attack.response.body"
                },
                {
                  "var": "attack.metadata.regex"
                }
              ]
            }
          }
        },
        {
          "id": "sqlinjection_2",
          "name": "SQL Injection - Single Quote (after)",
          "action": {
            "params": [
              {
                "value": "'",
                "position": "after",
                "operation": "add"
              }
            ]
          },
          "validation": {
            "rule": {
              "regex": [
                {
                  "var": "attack.response.body"
                },
                {
                  "var": "attack.metadata.regex"
                }
              ]
            },
            "proof": {
              "proof": [
                {
                  "var": "attack.response.body"
                },
                {
                  "var": "attack.metadata.regex"
                }
              ]
            }
          }
        },
        {
          "id": "sqlinjection_4",
          "name": "SQL Injection - Double Quote (after)",
          "action": {
            "params": [
              {
                "value": "\"",
                "position": "after",
                "operation": "add"
              }
            ]
          },
          "validation": {
            "rule": {
              "regex": [
                {
                  "var": "attack.response.body"
                },
                {
                  "var": "attack.metadata.regex"
                }
              ]
            },
            "proof": {
              "proof": [
                {
                  "var": "attack.response.body"
                },
                {
                  "var": "attack.metadata.regex"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "id": "os_command_injection",
      "type": "active",
      "async": true,
      "name": "OS command injection",
      "metadata": {
        "description": "OS command injection (also known as shell injection) is a web security vulnerability that allows an attacker to execute arbitrary operating system (OS) commands on the server that is running an application, and typically fully compromise the application and all its data.",
        "recommendation": "<p>Careful handling of all user input is crucial.</p>\r\n<ul>\r\n\t<li>Design: If at all possible, use library calls rather than external processes to recreate the desired functionality.</li>\r\n\t<li>Implementation: Ensure that all external commands called from the program are statically created, or - if they must take input from a user - that the input and final line generated are vigorously allow-list checked.</li>\r\n\t<li>Run time: Run time policy enforcement may be used in an allow-list fashion to prevent use of any non-sanctioned commands.</li>\r\n</ul>",
        "links": {
          "OWASP": "https://owasp.org/www-community/attacks/Command_Injection",
          "CWE": "https://cwe.mitre.org/data/definitions/78.html"
        },
        "severity": "high",
        "unique": true,
        "category": "injection",
        "owasp": ["A05:2025 - Injection", "A03:2021 - Injection"],
        "cwe": ["CWE-78"],
        "tags": ["dast", "command", "injection"],
        "vulnId": "command_injection"
      },
      "attacks": [
        {
          "id": "oscommand_1",
          "name": "OS Command Injection - Unix File (cat passwd)",
          "regex": "\\broot:.{0,20}:\\d+:\\d+:.{0,60}:|Exception: Could not find a part of the path|Exception: Could not find file",
          "action": {
            "params": [
              {
                "value": "|/bin/cat /etc/passwd",
                "position": "after",
                "operation": "add"
              }
            ]
          },
          "validation": {
            "rule": {
              "regex": [
                {
                  "var": "attack.response.body"
                },
                {
                  "var": "attack.metadata.regex"
                }
              ]
            },
            "proof": {
              "proof": [
                {
                  "var": "attack.response.body"
                },
                {
                  "var": "attack.metadata.regex"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "id": "xss",
      "type": "active",
      "async": true,
      "name": "Reflected Cross-Site Scripting (XSS)",
      "metadata": {
        "description": "Reflected Cross-site Scripting (XSS) is another name for non-persistent XSS, where the attack doesn't load with the vulnerable web application but is originated by the victim loading the offending URI. In this article we will see some ways to test a web application for this kind of vulnerability.",
        "recommendation": "<p>Reflected XSS attacks are the most frequent type of XSS attacks found nowadays.</p><p>When a web application is vulnerable to this type of attack, it will pass unvalidated input sent through requests to the client. Reflected attacks are delivered to the victim in various ways, such as in an e-mail message, or through some specially crafted URI. When a user is tricked into clicking on the malicious link, the injected code travels to the vulnerable web site, which reflects the attack back to the user\\u2019s browser. The browser then executes the offending code because it came from a \"trusted\" server.</p>\r\n          <p>Commonly the attacker's code is written in the Javascript language, but other scripting languages are also used, e.g., ActionScript and VBScript.</p>\r\n          <p>Attackers typically leverage these vulnerabilities to install key loggers, steal victim cookies, perform clipboard theft, and change the content of the page (e.g. download links).</p>\r\n          <p>To remediate against reflected XSS vulnerabilities, strict filtering of HTML character encodings must be adhered to. In some cases, the web application may not be filtering some character encodings. For example, it may filter out \"&lt;script&gt;\", but might not filter \"%3Cscript%3E\" which simply includes another encoding of tags. A nice tool for testing character encodings is OWASP's CAL9000.</p>\r\n          <p>Filtering of all information sent to the server via form POST/GET and URL query parameters with a particular emphasis on filtering out HTML-specific characters is advised.</p>",
        "links": {
          "OWASP": "https://owasp.org/www-community/attacks/xss/",
          "CWE": "https://cwe.mitre.org/data/definitions/79.html"
        },
        "severity": "high",
        "unique": true,
        "category": "xss",
        "owasp": ["A05:2025 - Injection", "A03:2021 - Injection"],
        "cwe": ["CWE-79"],
        "tags": ["dast", "xss", "dom"],
        "vulnId": "reflected_xss"
      },
      "attacks": [
        {
          "id": "xss_1",
          "name": "XSS - Unfiltered <script> tag",
          "regex": "<script>alert\\(ptk_xss_1\\)\\s*<\\/script>",
          "action": {
            "params": [
              {
                "value": "<script>alert(ptk_xss_1)</script>",
                "position": "after",
                "operation": "add"
              }
            ]
          },
          "validation": {
            "rule": {
              "regex": [
                {
                  "var": "attack.response.body"
                },
                {
                  "var": "attack.metadata.regex"
                }
              ]
            },
            "proof": {
              "proof": [
                {
                  "var": "attack.response.body"
                },
                {
                  "var": "attack.metadata.regex"
                }
              ]
            }
          }
        },
        {
          "id": "xss_2",
          "name": "XSS - Script tag after noscript tag",
          "regex": "<\\/noscript><script>alert\\(ptk_xss_2\\)\\s*<\\/script>",
          "action": {
            "params": [
              {
                "value": "</noscript><script>alert(ptk_xss_2)</script>",
                "position": "after",
                "operation": "add"
              }
            ]
          },
          "validation": {
            "rule": {
              "regex": [
                {
                  "var": "attack.response.body"
                },
                {
                  "var": "attack.metadata.regex"
                }
              ]
            },
            "proof": {
              "proof": [
                {
                  "var": "attack.response.body"
                },
                {
                  "var": "attack.metadata.regex"
                }
              ]
            }
          }
        },
        {
          "id": "xss_3",
          "name": "XSS - Svg tag with animation event",
          "regex": "<svg><animate onbegin=alert\\(ptk_xss_3\\) attributeName=x dur=1s>",
          "action": {
            "params": [
              {
                "value": "<svg><animate onbegin=alert(ptk_xss_3) attributeName=x dur=1s>",
                "position": "after",
                "operation": "add"
              }
            ]
          },
          "validation": {
            "rule": {
              "regex": [
                {
                  "var": "attack.response.body"
                },
                {
                  "var": "attack.metadata.regex"
                }
              ]
            },
            "proof": {
              "proof": [
                {
                  "var": "attack.response.body"
                },
                {
                  "var": "attack.metadata.regex"
                }
              ]
            }
          }
        },
        {
          "id": "xss_4",
          "name": "XSS - Img onerror",
          "regex": "<img src=x onerror=window.postMessage\\({\"ptk\":\"%%random%%\"}\\)>",
          "action": {
            "random": "%%random%%",
            "params": [
              {
                "value": "<img src=x onerror=window.postMessage({\"ptk\":\"%%random%%\"})>",
                "position": "before",
                "operation": "add"
              }
            ]
          },
          "validation": {
            "rule": {
              "regex": [
                {
                  "var": "attack.response.body"
                },
                {
                  "var": "attack.metadata.regex"
                }
              ]
            },
            "proof": {
              "proof": [
                {
                  "var": "attack.response.body"
                },
                {
                  "var": "attack.metadata.regex"
                }
              ]
            }
          }
        },
        {
          "id": "xss_5",
          "name": "XSS - Img onerror",
          "regex": "<img src=x onerror=window.postMessage\\({\"ptk\":\"%%random%%\"}\\)>",
          "action": {
            "random": "%%random%%",
            "params": [
              {
                "value": "<><img src=x onerror=window.postMessage({\"ptk\":\"%%random%%\"})>",
                "position": "before",
                "operation": "add"
              }
            ]
          },
          "validation": {
            "rule": {
              "regex": [
                {
                  "var": "attack.response.body"
                },
                {
                  "var": "attack.metadata.regex"
                }
              ]
            },
            "proof": {
              "proof": [
                {
                  "var": "attack.response.body"
                },
                {
                  "var": "attack.metadata.regex"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "id": "jwt_injection",
      "type": "active",
      "async": false,
      "name": "JSON Web Token attacks",
      "metadata": {
        "description": "This attack occurs when an attacker alters the token and changes the hashing algorithm to indicate, through the none keyword, that the integrity of the token has already been verified",
        "recommendation": "<ul>\r\n  <li>Use a secure and up to date library to handle JWTs.</li>\r\n  <li>Ensure that the signature is valid, and that it is using the expected algorithm.</li>\r\n  <li>Use a strong HMAC key or a unique private key to sign them.</li>\r\n  <li>Ensure that there is no sensitive information exposed in the payload.</li>\r\n  <li>Ensure that JWTs are securely stored and transmitted.</li>\r\n  <li>See the <a href=\"https://cheatsheetseries.owasp.org/cheatsheets/JSON_Web_Token_for_Java_Cheat_Sheet.html\">OWASP JSON Web Tokens Cheat Sheet</a>.</li>\r\n</ul>",
        "links": {
          "OWASP": "https://cheatsheetseries.owasp.org/cheatsheets/JSON_Web_Token_for_Java_Cheat_Sheet.html",
          "CWE": "https://cwe.mitre.org/data/definitions/345.html"
        },
        "severity": "high",
        "unique": false,
        "regex": "(ey[A-Za-z0-9_=-]+)\\.([A-Za-z0-9_=-]+)\\.([A-Za-z0-9_-]{2,})",
        "category": "auth_session",
        "owasp": [
          "A07:2025 - Authentication Failures",
          "A07:2021 - Identification and Authentication Failures"
        ],
        "cwe": ["CWE-345"],
        "tags": ["dast", "jwt", "token"],
        "vulnId": "auth_failures"
      },
      "attacks": [
        {
          "id": "jwt_probe_no_both",
          "name": "JWT Probe (Authorization + JWT cookies removed)",
          "atomic": false,
          "description": "Remove Authorization header and JWT cookies to see if auth is required.",
          "condition": {
            "and": [
              {
                "or": [
                  {
                    "regex": [
                      {
                        "filter": [
                          {
                            "var": "original.request.headers"
                          },
                          {
                            "in": [
                              {
                                "var": "name"
                              },
                              ["Authorization", "authorization"]
                            ]
                          }
                        ]
                      },
                      {
                        "var": "attack.metadata.regex"
                      }
                    ]
                  },
                  {
                    "regex": [
                      {
                        "var": "original.request.cookies"
                      },
                      {
                        "var": "attack.metadata.regex"
                      }
                    ]
                  },
                  {
                    "regex": [
                      {
                        "filter": [
                          {
                            "var": "original.request.headers"
                          },
                          {
                            "in": [
                              {
                                "var": "name"
                              },
                              ["Cookie", "cookie"]
                            ]
                          }
                        ]
                      },
                      {
                        "var": "attack.metadata.regex"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          "action": {
            "headers": [
              {
                "name": "Authorization",
                "operation": "remove"
              }
            ],
            "cookies": [
              {
                "operation": "remove",
                "regex": "(ey[A-Za-z0-9_=-]+)\\.([A-Za-z0-9_=-]+)\\.([A-Za-z0-9_-]{2,})"
              }
            ]
          }
        },
        {
          "id": "jwt_probe_no_authz",
          "name": "JWT Probe (Authorization header removed)",
          "atomic": false,
          "description": "Remove Authorization header to see if header is required.",
          "condition": {
            "and": [
              {
                "regex": [
                  {
                    "filter": [
                      {
                        "var": "original.request.headers"
                      },
                      {
                        "in": [
                          {
                            "var": "name"
                          },
                          ["Authorization", "authorization"]
                        ]
                      }
                    ]
                  },
                  {
                    "var": "attack.metadata.regex"
                  }
                ]
              }
            ]
          },
          "action": {
            "headers": [
              {
                "name": "Authorization",
                "operation": "remove"
              }
            ]
          }
        },
        {
          "id": "jwt_probe_no_cookie",
          "name": "JWT Probe (JWT cookies removed)",
          "atomic": false,
          "description": "Remove JWT-like cookies to see if cookie is required.",
          "condition": {
            "and": [
              {
                "or": [
                  {
                    "regex": [
                      {
                        "var": "original.request.cookies"
                      },
                      {
                        "var": "attack.metadata.regex"
                      }
                    ]
                  },
                  {
                    "regex": [
                      {
                        "filter": [
                          {
                            "var": "original.request.headers"
                          },
                          {
                            "in": [
                              {
                                "var": "name"
                              },
                              ["Cookie", "cookie"]
                            ]
                          }
                        ]
                      },
                      {
                        "var": "attack.metadata.regex"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          "action": {
            "cookies": [
              {
                "operation": "remove",
                "regex": "(ey[A-Za-z0-9_=-]+)\\.([A-Za-z0-9_=-]+)\\.([A-Za-z0-9_-]{2,})"
              }
            ]
          }
        },
        {
          "id": "jwt_1",
          "name": "JWT None Algorithm (Cookie)",
          "atomic": false,
          "description": "Replace JWT inside cookie values with a 'none' algorithm header and no signature.",
          "condition": {
            "and": [
              {
                "or": [
                  {
                    "regex": [
                      {
                        "var": "original.request.cookies"
                      },
                      {
                        "var": "attack.metadata.regex"
                      }
                    ]
                  },
                  {
                    "regex": [
                      {
                        "filter": [
                          {
                            "var": "original.request.headers"
                          },
                          {
                            "in": [
                              {
                                "var": "name"
                              },
                              ["Cookie", "cookie"]
                            ]
                          }
                        ]
                      },
                      {
                        "var": "attack.metadata.regex"
                      }
                    ]
                  }
                ]
              },
              {
                "or": [
                  {
                    "and": [
                      {
                        "==": [
                          {
                            "var": "module.executed.0.metadata.id"
                          },
                          "jwt_probe_no_both"
                        ]
                      },

                      {
                        "or": [
                          {
                            "!": {
                              "==": [
                                {
                                  "var": "module.executed.0.response.statusCode"
                                },
                                {
                                  "var": "original.response.statusCode"
                                }
                              ]
                            }
                          },
                          {
                            ">": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.0.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              30
                            ]
                          },
                          {
                            "<": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.0.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              -30
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "and": [
                      {
                        "==": [
                          {
                            "var": "module.executed.1.metadata.id"
                          },
                          "jwt_probe_no_both"
                        ]
                      },

                      {
                        "or": [
                          {
                            "!": {
                              "==": [
                                {
                                  "var": "module.executed.1.response.statusCode"
                                },
                                {
                                  "var": "original.response.statusCode"
                                }
                              ]
                            }
                          },
                          {
                            ">": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.1.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              30
                            ]
                          },
                          {
                            "<": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.1.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              -30
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "and": [
                      {
                        "==": [
                          {
                            "var": "module.executed.2.metadata.id"
                          },
                          "jwt_probe_no_both"
                        ]
                      },

                      {
                        "or": [
                          {
                            "!": {
                              "==": [
                                {
                                  "var": "module.executed.2.response.statusCode"
                                },
                                {
                                  "var": "original.response.statusCode"
                                }
                              ]
                            }
                          },
                          {
                            ">": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.2.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              30
                            ]
                          },
                          {
                            "<": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.2.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              -30
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "and": [
                      {
                        "==": [
                          {
                            "var": "module.executed.3.metadata.id"
                          },
                          "jwt_probe_no_both"
                        ]
                      },

                      {
                        "or": [
                          {
                            "!": {
                              "==": [
                                {
                                  "var": "module.executed.3.response.statusCode"
                                },
                                {
                                  "var": "original.response.statusCode"
                                }
                              ]
                            }
                          },
                          {
                            ">": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.3.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              30
                            ]
                          },
                          {
                            "<": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.3.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              -30
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "and": [
                      {
                        "==": [
                          {
                            "var": "module.executed.4.metadata.id"
                          },
                          "jwt_probe_no_both"
                        ]
                      },

                      {
                        "or": [
                          {
                            "!": {
                              "==": [
                                {
                                  "var": "module.executed.4.response.statusCode"
                                },
                                {
                                  "var": "original.response.statusCode"
                                }
                              ]
                            }
                          },
                          {
                            ">": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.4.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              30
                            ]
                          },
                          {
                            "<": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.4.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              -30
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "or": [
                  {
                    "and": [
                      {
                        "==": [
                          {
                            "var": "module.executed.0.metadata.id"
                          },
                          "jwt_probe_no_cookie"
                        ]
                      },

                      {
                        "or": [
                          {
                            "!": {
                              "==": [
                                {
                                  "var": "module.executed.0.response.statusCode"
                                },
                                {
                                  "var": "original.response.statusCode"
                                }
                              ]
                            }
                          },
                          {
                            ">": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.0.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              30
                            ]
                          },
                          {
                            "<": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.0.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              -30
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "and": [
                      {
                        "==": [
                          {
                            "var": "module.executed.1.metadata.id"
                          },
                          "jwt_probe_no_cookie"
                        ]
                      },

                      {
                        "or": [
                          {
                            "!": {
                              "==": [
                                {
                                  "var": "module.executed.1.response.statusCode"
                                },
                                {
                                  "var": "original.response.statusCode"
                                }
                              ]
                            }
                          },
                          {
                            ">": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.1.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              30
                            ]
                          },
                          {
                            "<": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.1.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              -30
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "and": [
                      {
                        "==": [
                          {
                            "var": "module.executed.2.metadata.id"
                          },
                          "jwt_probe_no_cookie"
                        ]
                      },

                      {
                        "or": [
                          {
                            "!": {
                              "==": [
                                {
                                  "var": "module.executed.2.response.statusCode"
                                },
                                {
                                  "var": "original.response.statusCode"
                                }
                              ]
                            }
                          },
                          {
                            ">": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.2.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              30
                            ]
                          },
                          {
                            "<": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.2.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              -30
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "and": [
                      {
                        "==": [
                          {
                            "var": "module.executed.3.metadata.id"
                          },
                          "jwt_probe_no_cookie"
                        ]
                      },

                      {
                        "or": [
                          {
                            "!": {
                              "==": [
                                {
                                  "var": "module.executed.3.response.statusCode"
                                },
                                {
                                  "var": "original.response.statusCode"
                                }
                              ]
                            }
                          },
                          {
                            ">": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.3.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              30
                            ]
                          },
                          {
                            "<": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.3.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              -30
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "and": [
                      {
                        "==": [
                          {
                            "var": "module.executed.4.metadata.id"
                          },
                          "jwt_probe_no_cookie"
                        ]
                      },

                      {
                        "or": [
                          {
                            "!": {
                              "==": [
                                {
                                  "var": "module.executed.4.response.statusCode"
                                },
                                {
                                  "var": "original.response.statusCode"
                                }
                              ]
                            }
                          },
                          {
                            ">": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.4.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              30
                            ]
                          },
                          {
                            "<": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.4.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              -30
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          },
          "action": {
            "cookies": [
              {
                "value": "eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.$2.",
                "regex": "(ey[A-Za-z0-9_=-]+)\\.([A-Za-z0-9_=-]+)\\.([A-Za-z0-9_-]{2,})"
              }
            ]
          },
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "attack.request.cookies"
                    },
                    "eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0\\."
                  ]
                },
                {
                  "==": [
                    {
                      "var": "attack.response.statusCode"
                    },
                    {
                      "var": "original.response.statusCode"
                    }
                  ]
                },
                {
                  "<=": [
                    {
                      "-": [
                        {
                          "var": "attack.response.length"
                        },
                        {
                          "var": "original.response.length"
                        }
                      ]
                    },
                    30
                  ]
                },
                {
                  ">=": [
                    {
                      "-": [
                        {
                          "var": "attack.response.length"
                        },
                        {
                          "var": "original.response.length"
                        }
                      ]
                    },
                    -30
                  ]
                },
                {
                  "or": [
                    {
                      "and": [
                        {
                          "==": [
                            {
                              "var": "module.executed.0.metadata.id"
                            },
                            "jwt_probe_no_cookie"
                          ]
                        },

                        {
                          "or": [
                            {
                              "!": {
                                "==": [
                                  {
                                    "var": "module.executed.0.response.statusCode"
                                  },
                                  {
                                    "var": "attack.response.statusCode"
                                  }
                                ]
                              }
                            },
                            {
                              ">": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.0.response.length"
                                    }
                                  ]
                                },
                                30
                              ]
                            },
                            {
                              "<": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.0.response.length"
                                    }
                                  ]
                                },
                                -30
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "and": [
                        {
                          "==": [
                            {
                              "var": "module.executed.1.metadata.id"
                            },
                            "jwt_probe_no_cookie"
                          ]
                        },

                        {
                          "or": [
                            {
                              "!": {
                                "==": [
                                  {
                                    "var": "module.executed.1.response.statusCode"
                                  },
                                  {
                                    "var": "attack.response.statusCode"
                                  }
                                ]
                              }
                            },
                            {
                              ">": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.1.response.length"
                                    }
                                  ]
                                },
                                30
                              ]
                            },
                            {
                              "<": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.1.response.length"
                                    }
                                  ]
                                },
                                -30
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "and": [
                        {
                          "==": [
                            {
                              "var": "module.executed.2.metadata.id"
                            },
                            "jwt_probe_no_cookie"
                          ]
                        },

                        {
                          "or": [
                            {
                              "!": {
                                "==": [
                                  {
                                    "var": "module.executed.2.response.statusCode"
                                  },
                                  {
                                    "var": "attack.response.statusCode"
                                  }
                                ]
                              }
                            },
                            {
                              ">": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.2.response.length"
                                    }
                                  ]
                                },
                                30
                              ]
                            },
                            {
                              "<": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.2.response.length"
                                    }
                                  ]
                                },
                                -30
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "and": [
                        {
                          "==": [
                            {
                              "var": "module.executed.3.metadata.id"
                            },
                            "jwt_probe_no_cookie"
                          ]
                        },

                        {
                          "or": [
                            {
                              "!": {
                                "==": [
                                  {
                                    "var": "module.executed.3.response.statusCode"
                                  },
                                  {
                                    "var": "attack.response.statusCode"
                                  }
                                ]
                              }
                            },
                            {
                              ">": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.3.response.length"
                                    }
                                  ]
                                },
                                30
                              ]
                            },
                            {
                              "<": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.3.response.length"
                                    }
                                  ]
                                },
                                -30
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "and": [
                        {
                          "==": [
                            {
                              "var": "module.executed.4.metadata.id"
                            },
                            "jwt_probe_no_cookie"
                          ]
                        },

                        {
                          "or": [
                            {
                              "!": {
                                "==": [
                                  {
                                    "var": "module.executed.4.response.statusCode"
                                  },
                                  {
                                    "var": "attack.response.statusCode"
                                  }
                                ]
                              }
                            },
                            {
                              ">": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.4.response.length"
                                    }
                                  ]
                                },
                                30
                              ]
                            },
                            {
                              "<": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.4.response.length"
                                    }
                                  ]
                                },
                                -30
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "and": [
                        {
                          "==": [
                            {
                              "var": "module.executed.0.metadata.id"
                            },
                            "jwt_probe_no_both"
                          ]
                        },

                        {
                          "or": [
                            {
                              "!": {
                                "==": [
                                  {
                                    "var": "module.executed.0.response.statusCode"
                                  },
                                  {
                                    "var": "attack.response.statusCode"
                                  }
                                ]
                              }
                            },
                            {
                              ">": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.0.response.length"
                                    }
                                  ]
                                },
                                30
                              ]
                            },
                            {
                              "<": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.0.response.length"
                                    }
                                  ]
                                },
                                -30
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "jwt_2",
          "name": "JWT None Algorithm (Form body param)",
          "atomic": false,
          "description": "Replace JWT present in x-www-form-urlencoded body params.",
          "condition": {
            "and": [
              {
                "<": [
                  {
                    "var": "original.response.statusCode"
                  },
                  500
                ]
              },
              {
                "regex": [
                  {
                    "var": "original.request.body.params"
                  },
                  {
                    "var": "attack.metadata.regex"
                  }
                ]
              }
            ]
          },
          "action": {
            "params": [
              {
                "value": "eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.$2.",
                "regex": "(ey[A-Za-z0-9_=-]+)\\.([A-Za-z0-9_=-]+)\\.([A-Za-z0-9_-]{2,})"
              }
            ]
          },
          "validation": {
            "rule": {
              "and": [
                {
                  "==": [
                    {
                      "var": "attack.response.statusCode"
                    },
                    {
                      "var": "original.response.statusCode"
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "jwt_3",
          "name": "JWT None Algorithm (Authorization header)",
          "atomic": false,
          "description": "Replace JWT in Authorization: Bearer <token> header.",
          "condition": {
            "and": [
              {
                "<": [
                  {
                    "var": "original.response.statusCode"
                  },
                  500
                ]
              },
              {
                "regex": [
                  {
                    "filter": [
                      {
                        "var": "original.request.headers"
                      },
                      {
                        "in": [
                          {
                            "var": "name"
                          },
                          ["Authorization", "authorization"]
                        ]
                      }
                    ]
                  },
                  {
                    "var": "attack.metadata.regex"
                  }
                ]
              },
              {
                "or": [
                  {
                    "and": [
                      {
                        "==": [
                          {
                            "var": "module.executed.0.metadata.id"
                          },
                          "jwt_probe_no_authz"
                        ]
                      },

                      {
                        "or": [
                          {
                            "!": {
                              "==": [
                                {
                                  "var": "module.executed.0.response.statusCode"
                                },
                                {
                                  "var": "original.response.statusCode"
                                }
                              ]
                            }
                          },
                          {
                            ">": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.0.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              30
                            ]
                          },
                          {
                            "<": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.0.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              -30
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "and": [
                      {
                        "==": [
                          {
                            "var": "module.executed.1.metadata.id"
                          },
                          "jwt_probe_no_authz"
                        ]
                      },

                      {
                        "or": [
                          {
                            "!": {
                              "==": [
                                {
                                  "var": "module.executed.1.response.statusCode"
                                },
                                {
                                  "var": "original.response.statusCode"
                                }
                              ]
                            }
                          },
                          {
                            ">": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.1.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              30
                            ]
                          },
                          {
                            "<": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.1.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              -30
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "and": [
                      {
                        "==": [
                          {
                            "var": "module.executed.2.metadata.id"
                          },
                          "jwt_probe_no_authz"
                        ]
                      },

                      {
                        "or": [
                          {
                            "!": {
                              "==": [
                                {
                                  "var": "module.executed.2.response.statusCode"
                                },
                                {
                                  "var": "original.response.statusCode"
                                }
                              ]
                            }
                          },
                          {
                            ">": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.2.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              30
                            ]
                          },
                          {
                            "<": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.2.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              -30
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "and": [
                      {
                        "==": [
                          {
                            "var": "module.executed.3.metadata.id"
                          },
                          "jwt_probe_no_authz"
                        ]
                      },

                      {
                        "or": [
                          {
                            "!": {
                              "==": [
                                {
                                  "var": "module.executed.3.response.statusCode"
                                },
                                {
                                  "var": "original.response.statusCode"
                                }
                              ]
                            }
                          },
                          {
                            ">": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.3.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              30
                            ]
                          },
                          {
                            "<": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.3.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              -30
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "and": [
                      {
                        "==": [
                          {
                            "var": "module.executed.4.metadata.id"
                          },
                          "jwt_probe_no_authz"
                        ]
                      },

                      {
                        "or": [
                          {
                            "!": {
                              "==": [
                                {
                                  "var": "module.executed.4.response.statusCode"
                                },
                                {
                                  "var": "original.response.statusCode"
                                }
                              ]
                            }
                          },
                          {
                            ">": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.4.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              30
                            ]
                          },
                          {
                            "<": [
                              {
                                "-": [
                                  {
                                    "var": "module.executed.4.response.length"
                                  },
                                  {
                                    "var": "original.response.length"
                                  }
                                ]
                              },
                              -30
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          },
          "action": {
            "headers": [
              {
                "name": "Authorization",
                "value": "$1eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.$3.",
                "regex": "(Bearer\\s+)?(ey[A-Za-z0-9_=-]+)\\.([A-Za-z0-9_=-]+)\\.([A-Za-z0-9_-]{2,})"
              }
            ]
          },
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "attack.request.headers"
                    },
                    "eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0\\."
                  ]
                },
                {
                  "==": [
                    {
                      "var": "attack.response.statusCode"
                    },
                    {
                      "var": "original.response.statusCode"
                    }
                  ]
                },
                {
                  "<=": [
                    {
                      "-": [
                        {
                          "var": "attack.response.length"
                        },
                        {
                          "var": "original.response.length"
                        }
                      ]
                    },
                    30
                  ]
                },
                {
                  ">=": [
                    {
                      "-": [
                        {
                          "var": "attack.response.length"
                        },
                        {
                          "var": "original.response.length"
                        }
                      ]
                    },
                    -30
                  ]
                },
                {
                  "or": [
                    {
                      "and": [
                        {
                          "==": [
                            {
                              "var": "module.executed.0.metadata.id"
                            },
                            "jwt_probe_no_authz"
                          ]
                        },

                        {
                          "or": [
                            {
                              "!": {
                                "==": [
                                  {
                                    "var": "module.executed.0.response.statusCode"
                                  },
                                  {
                                    "var": "attack.response.statusCode"
                                  }
                                ]
                              }
                            },
                            {
                              ">": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.0.response.length"
                                    }
                                  ]
                                },
                                30
                              ]
                            },
                            {
                              "<": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.0.response.length"
                                    }
                                  ]
                                },
                                -30
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "and": [
                        {
                          "==": [
                            {
                              "var": "module.executed.1.metadata.id"
                            },
                            "jwt_probe_no_authz"
                          ]
                        },

                        {
                          "or": [
                            {
                              "!": {
                                "==": [
                                  {
                                    "var": "module.executed.1.response.statusCode"
                                  },
                                  {
                                    "var": "attack.response.statusCode"
                                  }
                                ]
                              }
                            },
                            {
                              ">": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.1.response.length"
                                    }
                                  ]
                                },
                                30
                              ]
                            },
                            {
                              "<": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.1.response.length"
                                    }
                                  ]
                                },
                                -30
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "and": [
                        {
                          "==": [
                            {
                              "var": "module.executed.2.metadata.id"
                            },
                            "jwt_probe_no_authz"
                          ]
                        },

                        {
                          "or": [
                            {
                              "!": {
                                "==": [
                                  {
                                    "var": "module.executed.2.response.statusCode"
                                  },
                                  {
                                    "var": "attack.response.statusCode"
                                  }
                                ]
                              }
                            },
                            {
                              ">": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.2.response.length"
                                    }
                                  ]
                                },
                                30
                              ]
                            },
                            {
                              "<": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.2.response.length"
                                    }
                                  ]
                                },
                                -30
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "and": [
                        {
                          "==": [
                            {
                              "var": "module.executed.3.metadata.id"
                            },
                            "jwt_probe_no_authz"
                          ]
                        },

                        {
                          "or": [
                            {
                              "!": {
                                "==": [
                                  {
                                    "var": "module.executed.3.response.statusCode"
                                  },
                                  {
                                    "var": "attack.response.statusCode"
                                  }
                                ]
                              }
                            },
                            {
                              ">": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.3.response.length"
                                    }
                                  ]
                                },
                                30
                              ]
                            },
                            {
                              "<": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.3.response.length"
                                    }
                                  ]
                                },
                                -30
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "and": [
                        {
                          "==": [
                            {
                              "var": "module.executed.4.metadata.id"
                            },
                            "jwt_probe_no_authz"
                          ]
                        },

                        {
                          "or": [
                            {
                              "!": {
                                "==": [
                                  {
                                    "var": "module.executed.4.response.statusCode"
                                  },
                                  {
                                    "var": "attack.response.statusCode"
                                  }
                                ]
                              }
                            },
                            {
                              ">": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.4.response.length"
                                    }
                                  ]
                                },
                                30
                              ]
                            },
                            {
                              "<": [
                                {
                                  "-": [
                                    {
                                      "var": "attack.response.length"
                                    },
                                    {
                                      "var": "module.executed.4.response.length"
                                    }
                                  ]
                                },
                                -30
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "jwt_4",
          "name": "JWT None Algorithm (JSON body)",
          "atomic": false,
          "description": "Replace JWT inside any JSON body leaf value.",
          "condition": {
            "and": [
              {
                "<": [
                  {
                    "var": "original.response.statusCode"
                  },
                  500
                ]
              },
              {
                "or": [
                  {
                    "regex": [
                      {
                        "var": "original.request.body.text"
                      },
                      {
                        "var": "attack.metadata.regex"
                      }
                    ]
                  },
                  {
                    "regex": [
                      {
                        "var": "original.request.body.json"
                      },
                      {
                        "var": "attack.metadata.regex"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          "action": {
            "params": [
              {
                "value": "eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.$2.",
                "regex": "(ey[A-Za-z0-9_=-]+)\\.([A-Za-z0-9_=-]+)\\.([A-Za-z0-9_-]{2,})"
              }
            ]
          },
          "validation": {
            "rule": {
              "and": [
                {
                  "==": [
                    {
                      "var": "attack.response.statusCode"
                    },
                    {
                      "var": "original.response.statusCode"
                    }
                  ]
                }
              ]
            }
          }
        }
      ]
    },
    {
      "id": "version_control_exposure",
      "type": "active",
      "async": true,
      "name": "Exposure of Version-Control Repository",
      "metadata": {
        "description": "Version control repositories such as CVS or git store version-specific metadata and other details within subdirectories. If these subdirectories are stored on a web server or added to an archive, then these could be used by an attacker. This information may include usernames, filenames, path root, IP addresses, and detailed 'diff' data about how files have been changed - which could reveal source code snippets that were never intended to be made public..",
        "recommendation": "<p>Recommendations include removing any version control directories and repositories from the production server, disabling the use of remote version control repositories, and ensuring that the latest version control patches and version updates have been performed.</p>",
        "links": {
          "OWASP": "https://owasp.org/Top10/A05_2021-Security_Misconfiguration/",
          "CWE": "https://cwe.mitre.org/data/definitions/527.html"
        },
        "severity": "medium",
        "unique": true,
        "category": "sensitive_data",
        "owasp": [
          "A02:2025 - Security Misconfiguration",
          "A05:2021 - Security Misconfiguration"
        ],
        "cwe": ["CWE-527"],
        "tags": ["dast", "info_leakage", "vcs"],
        "vulnId": "info_disclosure"
      },
      "attacks": [
        {
          "id": "repo_1",
          "name": "Exposure of Git repository",
          "regex": "Index of \\/.git",
          "action": {
            "url": {
              "value": "/.git/",
              "position": "after",
              "operation": "add"
            }
          },
          "validation": {
            "rule": {
              "and": [
                {
                  "==": [
                    {
                      "var": "attack.response.statusCode"
                    },
                    200
                  ]
                },
                {
                  "regex": [
                    {
                      "var": "attack.response.body"
                    },
                    {
                      "var": "attack.metadata.regex"
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "repo_2",
          "name": "Exposure of SVN repository",
          "regex": "Index of \\/.svn",
          "action": {
            "url": {
              "value": "/.svn/",
              "position": "after",
              "operation": "add"
            }
          },
          "validation": {
            "rule": {
              "and": [
                {
                  "==": [
                    {
                      "var": "attack.response.statusCode"
                    },
                    200
                  ]
                },
                {
                  "regex": [
                    {
                      "var": "attack.response.body"
                    },
                    {
                      "var": "attack.metadata.regex"
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "repo_3",
          "name": "Exposure of Mercurial repository",
          "regex": "Index of \\/.hg",
          "action": {
            "url": {
              "value": "/.hg/",
              "position": "after",
              "operation": "add"
            }
          },
          "validation": {
            "rule": {
              "and": [
                {
                  "==": [
                    {
                      "var": "attack.response.statusCode"
                    },
                    200
                  ]
                },
                {
                  "regex": [
                    {
                      "var": "attack.response.body"
                    },
                    {
                      "var": "attack.metadata.regex"
                    }
                  ]
                }
              ]
            }
          }
        }
      ]
    },
    {
      "id": "headers",
      "type": "passive",
      "name": "OWASP Secure Headers",
      "metadata": {
        "description": "The OWASP Secure Headers Project describes HTTP response headers that your application can use to increase the security of your application. Once set, these HTTP response headers can restrict modern browsers from running into easily preventable vulnerabilities. ",
        "recommendation": "<p>Configure security-related HTTP response headers consistently on all responses to harden the application against common browser-based attacks.</p>\n<ul>\n  <li><strong>HSTS</strong>  enforce HTTPS with a long <code>max-age</code> and <code>includeSubDomains</code> where appropriate.</li>\n  <li><strong>Content-Security-Policy</strong>  restrict scripts, styles, frames and connections to trusted sources only.</li>\n  <li><strong>Referrer-Policy</strong>  limit referrer information sent to other origins.</li>\n  <li><strong>X-Content-Type-Options</strong>  use <code>nosniff</code> to prevent MIME type confusion.</li>\n  <li><strong>Cookies</strong>  set <code>Secure</code>, <code>HttpOnly</code> and <code>SameSite</code> attributes on sensitive cookies.</li>\n  <li>Remove unnecessary disclosure headers such as <code>Server</code> and <code>X-Powered-By</code> where possible.</li>\n</ul>",
        "links": {
          "OWASP": "https://owasp.org/www-project-secure-headers/",
          "CWE": "https://cwe.mitre.org/data/definitions/693.html"
        },
        "severity": "low",
        "unique": false,
        "category": "hardening",
        "owasp": [
          "A02:2025 - Security Misconfiguration",
          "A05:2021 - Security Misconfiguration"
        ],
        "cwe": ["CWE-693"],
        "tags": ["dast", "hardening", "headers"],
        "vulnId": "security_headers"
      },
      "attacks": [
        {
          "id": "header_csp_missing",
          "name": "Missing Content-Security-Policy header",
          "validation": {
            "rule": {
              "none": [
                {
                  "var": "original.response.headers"
                },
                {
                  "regex": [
                    {
                      "var": "name"
                    },
                    "^content-security-policy$",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "header_csp_weak_scripts",
          "name": "CSP allows inline/eval or wildcards in script/style",
          "validation": {
            "rule": {
              "some": [
                {
                  "var": "original.response.headers"
                },
                {
                  "and": [
                    {
                      "regex": [
                        {
                          "var": "name"
                        },
                        "^content-security-policy$",
                        "i"
                      ]
                    },
                    {
                      "or": [
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            "'unsafe-inline'",
                            "i"
                          ]
                        },
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            "'unsafe-eval'",
                            "i"
                          ]
                        },
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            "script-src[^;]*\\*",
                            "i"
                          ]
                        },
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            "style-src[^;]*\\*",
                            "i"
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "header_csp_frame_ancestors_missing_or_weak",
          "name": "CSP 'frame-ancestors' missing or overly broad",
          "validation": {
            "rule": {
              "some": [
                {
                  "var": "original.response.headers"
                },
                {
                  "and": [
                    {
                      "regex": [
                        {
                          "var": "name"
                        },
                        "^content-security-policy$",
                        "i"
                      ]
                    },
                    {
                      "or": [
                        {
                          "!": {
                            "regex": [
                              {
                                "var": "value"
                              },
                              "frame-ancestors",
                              "i"
                            ]
                          }
                        },
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            "frame-ancestors[^;]*\\*",
                            "i"
                          ]
                        },
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            "frame-ancestors[^;]*https?://",
                            "i"
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "header_csp_report_only_without_enforce",
          "name": "CSP Report-Only present without enforcing CSP",
          "validation": {
            "rule": {
              "and": [
                {
                  "some": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "regex": [
                        {
                          "var": "name"
                        },
                        "^content-security-policy-report-only$",
                        "i"
                      ]
                    }
                  ]
                },
                {
                  "none": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "regex": [
                        {
                          "var": "name"
                        },
                        "^content-security-policy$",
                        "i"
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "header_hsts_missing",
          "name": "Missing Strict-Transport-Security header (on HTTPS)",
          "validation": {
            "rule": {
              "and": [
                {
                  "var": "original.response.isHttps"
                },
                {
                  "none": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "regex": [
                        {
                          "var": "name"
                        },
                        "^strict-transport-security$",
                        "i"
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "header_hsts_ineffective_on_http",
          "name": "Strict-Transport-Security sent over HTTP (ineffective)",
          "validation": {
            "rule": {
              "and": [
                {
                  "!": {
                    "var": "original.response.isHttps"
                  }
                },
                {
                  "some": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "regex": [
                        {
                          "var": "name"
                        },
                        "^strict-transport-security$",
                        "i"
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "header_hsts_weak",
          "name": "HSTS max-age too low or missing includeSubDomains",
          "validation": {
            "rule": {
              "some": [
                {
                  "var": "original.response.headers"
                },
                {
                  "and": [
                    {
                      "regex": [
                        {
                          "var": "name"
                        },
                        "^strict-transport-security$",
                        "i"
                      ]
                    },
                    {
                      "or": [
                        {
                          "!": {
                            "regex": [
                              {
                                "var": "value"
                              },
                              "max-age\\s*=\\s*(\\d+)",
                              "i"
                            ]
                          }
                        },
                        {
                          "and": [
                            {
                              "regex": [
                                {
                                  "var": "value"
                                },
                                "max-age\\s*=\\s*(\\d+)",
                                "i",
                                "hstsAge"
                              ]
                            },
                            {
                              "<": [
                                {
                                  "var": "captures.hstsAge.1"
                                },
                                15552000
                              ]
                            }
                          ]
                        },
                        {
                          "!": {
                            "regex": [
                              {
                                "var": "value"
                              },
                              "includesubdomains",
                              "i"
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "header_powered_by_present",
          "name": "X-Powered-By header or equivalent present",
          "validation": {
            "rule": {
              "some": [
                {
                  "var": "original.response.headers"
                },
                {
                  "regex": [
                    {
                      "var": "name"
                    },
                    "^(x-(server-)?powered-(by|cms)|powered-by|x-cf-powered-by)$",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "header_server_banner_disclosure",
          "name": "Server banner discloses software/version",
          "validation": {
            "rule": {
              "some": [
                {
                  "var": "original.response.headers"
                },
                {
                  "and": [
                    {
                      "regex": [
                        {
                          "var": "name"
                        },
                        "^server$",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "value"
                        },
                        "\\/\\d|apache|nginx|iis|tomcat|gunicorn|caddy|lighttpd|express|kestrel",
                        "i"
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "header_x_frame_options_obsolete",
          "name": "X-Frame-Options header is a legacy directive",
          "validation": {
            "rule": {
              "some": [
                {
                  "var": "original.response.headers"
                },
                {
                  "regex": [
                    {
                      "var": "name"
                    },
                    "^x-frame-options$",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "header_xss_protection_obsolete",
          "name": "X-XSS-Protection header is a legacy directive",
          "validation": {
            "rule": {
              "some": [
                {
                  "var": "original.response.headers"
                },
                {
                  "regex": [
                    {
                      "var": "name"
                    },
                    "^x-xss-protection$",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "header_expect_ct_obsolete",
          "name": "Expect-CT is deprecated",
          "validation": {
            "rule": {
              "some": [
                {
                  "var": "original.response.headers"
                },
                {
                  "regex": [
                    {
                      "var": "name"
                    },
                    "^expect-ct$",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "header_coop_without_coep_or_corp",
          "name": "COOP set without COEP/CORP (incomplete cross-origin isolation)",
          "validation": {
            "rule": {
              "and": [
                {
                  "some": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "regex": [
                        {
                          "var": "name"
                        },
                        "^cross-origin-opener-policy$",
                        "i"
                      ]
                    }
                  ]
                },
                {
                  "none": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "regex": [
                        {
                          "var": "name"
                        },
                        "^cross-origin-embedder-policy$",
                        "i"
                      ]
                    }
                  ]
                },
                {
                  "none": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "regex": [
                        {
                          "var": "name"
                        },
                        "^cross-origin-resource-policy$",
                        "i"
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "header_coep_value_weak",
          "name": "COEP present but value is not 'require-corp' or 'credentialless'",
          "validation": {
            "rule": {
              "some": [
                {
                  "var": "original.response.headers"
                },
                {
                  "and": [
                    {
                      "regex": [
                        {
                          "var": "name"
                        },
                        "^cross-origin-embedder-policy$",
                        "i"
                      ]
                    },
                    {
                      "!": {
                        "regex": [
                          {
                            "var": "value"
                          },
                          "^(\\s*require-corp\\s*|\\s*credentialless\\s*)$",
                          "i"
                        ]
                      }
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "header_permissions_policy_legacy_or_unknown",
          "name": "Deprecated Feature-Policy or unknown/overly-permissive Permissions-Policy",
          "validation": {
            "rule": {
              "or": [
                {
                  "some": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "regex": [
                        {
                          "var": "name"
                        },
                        "^feature-policy$",
                        "i"
                      ]
                    }
                  ]
                },
                {
                  "some": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "and": [
                        {
                          "regex": [
                            {
                              "var": "name"
                            },
                            "^permissions-policy$",
                            "i"
                          ]
                        },
                        {
                          "or": [
                            {
                              "regex": [
                                {
                                  "var": "value"
                                },
                                "(?<![a-z-])(vibrate|document-write|interest-cohort)\\s*=",
                                "i"
                              ]
                            },
                            {
                              "regex": [
                                {
                                  "var": "value"
                                },
                                "geolocation\\s*=\\s*\\*",
                                "i"
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "header_referrer_policy_missing_or_weak",
          "name": "Missing or weak Referrer-Policy",
          "validation": {
            "rule": {
              "or": [
                {
                  "none": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "regex": [
                        {
                          "var": "name"
                        },
                        "^referrer-policy$",
                        "i"
                      ]
                    }
                  ]
                },
                {
                  "some": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "and": [
                        {
                          "regex": [
                            {
                              "var": "name"
                            },
                            "^referrer-policy$",
                            "i"
                          ]
                        },
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            "^(\\s*|no-referrer-when-downgrade|unsafe-url)\\s*$",
                            "i"
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "header_clear_site_data_incomplete",
          "name": "Clear-Site-Data present but missing executionContexts",
          "validation": {
            "rule": {
              "some": [
                {
                  "var": "original.response.headers"
                },
                {
                  "and": [
                    {
                      "regex": [
                        {
                          "var": "name"
                        },
                        "^clear-site-data$",
                        "i"
                      ]
                    },
                    {
                      "!": {
                        "regex": [
                          {
                            "var": "value"
                          },
                          "\"?executioncontexts\"?",
                          "i"
                        ]
                      }
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "header_clear_site_data_wildcard",
          "name": "Clear-Site-Data uses wildcard *",
          "validation": {
            "rule": {
              "some": [
                {
                  "var": "original.response.headers"
                },
                {
                  "and": [
                    {
                      "regex": [
                        {
                          "var": "name"
                        },
                        "^clear-site-data$",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "value"
                        },
                        "\\*",
                        "i"
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "header_cors_wildcard_with_credentials",
          "name": "CORS allows any origin with credentials",
          "validation": {
            "rule": {
              "and": [
                {
                  "some": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "and": [
                        {
                          "regex": [
                            {
                              "var": "name"
                            },
                            "^access-control-allow-origin$",
                            "i"
                          ]
                        },
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            "^\\s*\\*\\s*$",
                            "i"
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "some": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "and": [
                        {
                          "regex": [
                            {
                              "var": "name"
                            },
                            "^access-control-allow-credentials$",
                            "i"
                          ]
                        },
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            "true",
                            "i"
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "header_set_cookie_flags_missing",
          "name": "Sensitive cookies missing security flags",
          "validation": {
            "rule": {
              "some": [
                {
                  "var": "original.response.headers"
                },
                {
                  "and": [
                    {
                      "regex": [
                        {
                          "var": "name"
                        },
                        "^set-cookie$",
                        "i"
                      ]
                    },
                    {
                      "or": [
                        {
                          "!": {
                            "regex": [
                              {
                                "var": "value"
                              },
                              ";\\s*httponly\\b",
                              "i"
                            ]
                          }
                        },
                        {
                          "and": [
                            {
                              "var": "original.response.isHttps"
                            },
                            {
                              "!": {
                                "regex": [
                                  {
                                    "var": "value"
                                  },
                                  ";\\s*secure\\b",
                                  "i"
                                ]
                              }
                            }
                          ]
                        },
                        {
                          "!": {
                            "regex": [
                              {
                                "var": "value"
                              },
                              ";\\s*samesite\\s*=\\s*(lax|strict)",
                              "i"
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "header_cache_control_sensitive_missing_no_store",
          "name": "Potentially authenticated content lacks no-store",
          "validation": {
            "rule": {
              "and": [
                {
                  "some": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "regex": [
                        {
                          "var": "name"
                        },
                        "^set-cookie$",
                        "i"
                      ]
                    }
                  ]
                },
                {
                  "none": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "and": [
                        {
                          "regex": [
                            {
                              "var": "name"
                            },
                            "^cache-control$",
                            "i"
                          ]
                        },
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            "\\bno-store\\b",
                            "i"
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        }
      ]
    },
    {
      "id": "sensitive_data_exposure",
      "type": "passive",
      "name": "Sensitive data exposure",
      "metadata": {
        "description": "Sensitive data is anything that should not be accessible to unauthorized access, known as sensitive data. Sensitive data may include personally identifiable information (PII), such as Social Security numbers, financial information, or login credentials. Sensitive Data Exposure occurs when an organization unknowingly exposes sensitive data or when a security incident leads to the accidental or unlawful destruction, loss, alteration, or unauthorized disclosure of, or access to sensitive data. ",
        "recommendation": "<p>Treat credentials, personal data, tokens and financial information as sensitive and protect them throughout their lifecycle.</p>\n<ul>\n  <li>Classify what data is sensitive and avoid storing it unless there is a clear business need.</li>\n  <li>Encrypt sensitive data at rest and in transit using modern, well configured algorithms and keys.</li>\n  <li>Store passwords using strong, salted and adaptive hash functions such as <code>argon2</code>, <code>bcrypt</code> or <code>PBKDF2</code>.</li>\n  <li>Disable caching for responses that contain sensitive data and avoid exposing it in URLs, logs or client-side storage.</li>\n  <li>Regularly review configuration and implementation against up-to-date OWASP guidance.</li>\n</ul>",
        "links": {
          "OWASP": "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
          "CWE": "https://cwe.mitre.org/data/definitions/200.html"
        },
        "severity": "low",
        "unique": true,
        "category": "sensitive_data",
        "owasp": [
          "A04:2025 - Cryptographic Failures",
          "A02:2021 - Cryptographic Failures"
        ],
        "cwe": ["CWE-200"],
        "tags": ["dast", "info_leakage"],
        "vulnId": "info_disclosure"
      },
      "attacks": [
        {
          "id": "credit_card_number",
          "name": "Credit Card Number",
          "regex": "(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))",
          "regex1": "(Credit\\s)?Card\\s+Number|Method of Payment",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    {
                      "var": "attack.metadata.regex"
                    }
                  ]
                },
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    {
                      "var": "attack.metadata.regex1"
                    }
                  ]
                }
              ]
            },
            "proof": {
              "and": [
                {
                  "proof": [
                    {
                      "var": "original.response.body"
                    },
                    {
                      "var": "attack.metadata.regex"
                    }
                  ]
                },
                {
                  "proof": [
                    {
                      "var": "original.response.body"
                    },
                    {
                      "var": "attack.metadata.regex1"
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "social_securityn_umber",
          "name": "Social Security Number",
          "regex": "(?!666|000|9\\d{2})\\d{3}-(?!00)\\d{2}-(?!0{4})\\d{4}",
          "regex1": "(\\bSSN\\b)|Social\\sSecurity\\s(Number)?",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    {
                      "var": "attack.metadata.regex"
                    }
                  ]
                },
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    {
                      "var": "attack.metadata.regex1"
                    }
                  ]
                }
              ]
            },
            "proof": {
              "and": [
                {
                  "proof": [
                    {
                      "var": "original.response.body"
                    },
                    {
                      "var": "attack.metadata.regex"
                    }
                  ]
                },
                {
                  "proof": [
                    {
                      "var": "original.response.body"
                    },
                    {
                      "var": "attack.metadata.regex1"
                    }
                  ]
                }
              ]
            }
          }
        }
      ]
    },
    {
      "id": "spa_dom_xss",
      "type": "active",
      "async": true,
      "name": "SPA hash-based DOM XSS",
      "metadata": {
        "description": "Tests hash-based SPA parameters (http://host/#/route?param=...) for DOM XSS by mutating the hash in a dedicated attack tab and inspecting the DOM.",
        "severity": "high",
        "category": "xss",
        "spa": true,
        "links": {
          "OWASP": "https://owasp.org/www-community/attacks/xss/",
          "CWE": "https://cwe.mitre.org/data/definitions/79.html"
        },
        "owasp": ["A05:2025 - Injection", "A03:2021 - Injection"],
        "cwe": ["CWE-79"],
        "tags": ["dast", "spa", "xss"],
        "recommendation": "<p>Treat all hash-based parameters and client-side routing inputs as untrusted, and ensure they are never inserted into the DOM as HTML or script.</p>\n<ul>\n  <li>Use safe DOM APIs that set text content rather than HTML where user input is involved.</li>\n  <li>Avoid building HTML strings from concatenated parameters and instead use templating or component frameworks safely.</li>\n  <li>Combine these practices with a restrictive Content Security Policy to reduce exploitability.</li>\n</ul>",
        "vulnId": "dom_xss"
      },
      "attacks": [
        {
          "id": "spa_dom_xss_default",
          "name": "SPA hash DOM XSS",
          "spa": {
            "checks": ["dom_xss"],
            "payloads": [
              "<img src=x onerror=\"window.postMessage({source:'ptk-xss',id:'PTK_SPA_DOM_XSS_%%random%%'},'*')\">"
            ],
            "markerToken": "PTK_SPA_DOM_XSS_%%random%%"
          }
        }
      ]
    },
    {
      "id": "websocket_security",
      "type": "passive",
      "name": "WebSocket security indicators",
      "metadata": {
        "description": "Looks for common WebSocket endpoints and insecure patterns such as ws:// from HTTPS pages.",
        "recommendation": "<p>Protect WebSocket endpoints like any other authenticated API.</p>\n<ul>\n  <li>Use <code>wss://</code> for all WebSocket connections, especially from HTTPS origins.</li>\n  <li>Validate the Origin header and enforce authentication and authorisation on each connection.</li>\n  <li>Avoid exposing sensitive operations over publicly reachable WebSocket endpoints.</li>\n</ul>",
        "links": {
          "OWASP": "https://owasp.org/www-community/attacks/WebSocket",
          "CWE": "https://cwe.mitre.org/data/definitions/319.html"
        },
        "severity": "low",
        "unique": false,
        "category": "security_misconfiguration",
        "owasp": [
          "A04:2025 - Cryptographic Failures",
          "A02:2021 - Cryptographic Failures"
        ],
        "cwe": ["CWE-319"],
        "tags": ["dast", "websocket"],
        "vulnId": "websocket_misconfiguration"
      },
      "attacks": [
        {
          "id": "ws_1",
          "name": "ws:// from HTTPS context",
          "validation": {
            "rule": {
              "and": [
                {
                  "var": "original.response.isHttps"
                },
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "ws://"
                  ]
                }
              ]
            }
          }
        }
      ]
    },
    {
      "id": "recon_sourcemaps_debug",
      "type": "passive",
      "name": "Passive Recon: Source Maps & Debug Artifacts",
      "metadata": {
        "description": "Detects source map references and common debug artifacts in observed HTML/JS responses. These are high-value recon leads for code disclosure and hidden endpoints.",
        "recommendation": "<ul><li>Do not publish source maps to production unless required; restrict access or strip <code>sourceMappingURL</code> references.</li><li>Disable development tooling and verbose debug banners in production builds.</li></ul>",
        "links": {
          "MDN - Source maps": "https://developer.mozilla.org/en-US/docs/Tools/Debugger/How_to/Use_a_source_map",
          "OWASP": "https://cheatsheetseries.owasp.org/cheatsheets/Information_Leakage_Cheat_Sheet.html",
          "CWE": "https://cwe.mitre.org/data/definitions/200.html"
        },
        "severity": "low",
        "unique": true,
        "category": "sensitive_data",
        "owasp": [
          "A05:2021 - Security Misconfiguration",
          "A02:2025 - Security Misconfiguration"
        ],
        "cwe": ["CWE-200", "CWE-215"],
        "tags": ["dast", "recon", "passive", "javascript", "debug"],
        "vulnId": "info_disclosure"
      },
      "attacks": [
        {
          "id": "recon_sourcemap_in_js",
          "name": "JavaScript includes sourceMappingURL",
          "validation": {
            "rule": {
              "and": [
                {
                  "or": [
                    {
                      "some": [
                        {
                          "var": "original.response.headers"
                        },
                        {
                          "and": [
                            {
                              "regex": [
                                {
                                  "var": "name"
                                },
                                "^content-type$",
                                "i"
                              ]
                            },
                            {
                              "regex": [
                                {
                                  "var": "value"
                                },
                                "(application|text)/(javascript|ecmascript)|application/x-javascript",
                                "i"
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.url"
                        },
                        "\\.js(\\?|$)",
                        "i"
                      ]
                    }
                  ]
                },
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "//#\\s*sourceMappingURL\\s*=\\s*.+",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_sourcemap_reference_in_html",
          "name": "HTML references .map files",
          "validation": {
            "rule": {
              "and": [
                {
                  "some": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "and": [
                        {
                          "regex": [
                            {
                              "var": "name"
                            },
                            "^content-type$",
                            "i"
                          ]
                        },
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            "text/html",
                            "i"
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "\\.map(\\?|\\\"|\\'|<|$)",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_webpack_devserver_artifacts",
          "name": "Webpack dev-server / hot reload artifacts",
          "validation": {
            "rule": {
              "and": [
                {
                  "or": [
                    {
                      "some": [
                        {
                          "var": "original.response.headers"
                        },
                        {
                          "and": [
                            {
                              "regex": [
                                {
                                  "var": "name"
                                },
                                "^content-type$",
                                "i"
                              ]
                            },
                            {
                              "regex": [
                                {
                                  "var": "value"
                                },
                                "text/html|javascript",
                                "i"
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.url"
                        },
                        "\\.js(\\?|$)",
                        "i"
                      ]
                    }
                  ]
                },
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "webpack-dev-server|sockjs-node|__webpack_hmr|hot-update\\.json",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_nextjs_build_metadata",
          "name": "Next.js build metadata exposed",
          "validation": {
            "rule": {
              "and": [
                {
                  "some": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "and": [
                        {
                          "regex": [
                            {
                              "var": "name"
                            },
                            "^content-type$",
                            "i"
                          ]
                        },
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            "text/html",
                            "i"
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "__NEXT_DATA__|/_next/static/[^\\\"']+/",
                    "i"
                  ]
                }
              ]
            }
          }
        }
      ]
    },
    {
      "id": "recon_error_stacktraces",
      "type": "passive",
      "name": "Passive Recon: Error & Stack Trace Disclosure",
      "metadata": {
        "description": "Detects common framework stack traces, error pages, and path disclosures in observed responses.",
        "recommendation": "<ul><li>Return generic error messages to clients and log detailed errors server-side.</li><li>Disable debug/error pages in production and scrub internal paths/hostnames from responses.</li></ul>",
        "links": {
          "OWASP - Error Handling": "https://cheatsheetseries.owasp.org/cheatsheets/Error_Handling_Cheat_Sheet.html",
          "OWASP": "https://cheatsheetseries.owasp.org/cheatsheets/Error_Handling_Cheat_Sheet.html",
          "CWE": "https://cwe.mitre.org/data/definitions/209.html"
        },
        "severity": "medium",
        "unique": true,
        "category": "sensitive_data",
        "owasp": ["A05:2021 - Security Misconfiguration"],
        "cwe": ["CWE-209", "CWE-200"],
        "tags": ["dast", "recon", "passive", "errors", "infoleak"],
        "vulnId": "info_disclosure"
      },
      "attacks": [
        {
          "id": "recon_node_stacktrace",
          "name": "Node.js / Express stack trace",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "Error:\\s.+\\n\\s+at\\s.+\\(.+:\\d+:\\d+\\)",
                    "i"
                  ]
                },
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "\\bnode_modules\\b|express|webpack",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_java_stacktrace",
          "name": "Java stack trace",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "Exception in thread|java\\.lang\\.[A-Za-z]+Exception|at\\s+[a-zA-Z0-9_$.]+\\([A-Za-z0-9_.]+\\.java:\\d+\\)",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_dotnet_stacktrace",
          "name": ".NET stack trace / YSOD",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "System\\.[A-Za-z0-9_.]+Exception|at\\s+[A-Za-z0-9_.]+\\(.+\\)\\s+in\\s+.+:\\\\.+:\\s*line\\s*\\d+|Yellow Screen of Death",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_python_traceback",
          "name": "Python traceback",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "Traceback \\(most recent call last\\):|File \\\".+\\\", line \\d+, in .+",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_php_fatal_error",
          "name": "PHP fatal error / warning",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "Fatal error:|Warning:|Notice:|Parse error:",
                    "i"
                  ]
                },
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "on line \\d+|in <b>.+</b>",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_internal_path_disclosure",
          "name": "Internal file path disclosure",
          "validation": {
            "rule": {
              "or": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "/var/www/|/home/[a-z0-9_\\-]+/|/srv/|/opt/|C:\\\\\\\\inetpub\\\\\\\\|C:\\\\\\\\Windows\\\\\\\\",
                    "i"
                  ]
                }
              ]
            }
          }
        }
      ]
    },
    {
      "id": "recon_client_config_secrets",
      "type": "passive",
      "name": "Passive Recon: Client Config & Secret-Like Values",
      "metadata": {
        "description": "Flags secret-like tokens and exposed configuration values in observed HTML/JS/JSON responses. These are recon leads; validate sensitivity before reporting.",
        "recommendation": "<ul><li>Remove secrets from client-delivered assets and rotate exposed credentials.</li><li>Use automated secret scanning in CI/CD and pre-commit hooks.</li></ul>",
        "links": {
          "OWASP - Secrets Management": "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html",
          "OWASP": "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html",
          "CWE": "https://cwe.mitre.org/data/definitions/798.html"
        },
        "severity": "low",
        "unique": true,
        "category": "sensitive_data",
        "owasp": [
          "A02:2025 - Cryptographic Failures",
          "A05:2021 - Security Misconfiguration"
        ],
        "cwe": ["CWE-200", "CWE-798", "CWE-312"],
        "tags": ["dast", "recon", "passive", "secrets", "javascript"],
        "vulnId": "token_leak"
      },
      "attacks": [
        {
          "id": "recon_private_key_material",
          "name": "Private key material exposed",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "-----BEGIN (RSA|EC|OPENSSH|DSA|PGP)? ?PRIVATE KEY-----",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_aws_access_key_id",
          "name": "AWS Access Key ID pattern",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "\\b(AKIA|ASIA)[0-9A-Z]{16}\\b",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_slack_token",
          "name": "Slack token pattern",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "\\bxox[baprs]-[0-9A-Za-z-]{10,48}\\b",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_github_token",
          "name": "GitHub token pattern",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "\\bgh[pousr]_[0-9A-Za-z]{20,}\\b",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_sentry_dsn",
          "name": "Sentry DSN exposed",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "https?://[0-9a-f]{8,32}@[a-z0-9\\.\\-]+\\.ingest\\.sentry\\.io/\\d+",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_firebase_config",
          "name": "Firebase config exposed",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "firebase(app)?\\.initializeApp|\\\"apiKey\\\"\\s*:\\s*\\\"[A-Za-z0-9_\\-]{20,}\\\"",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_stripe_publishable_key",
          "name": "Stripe publishable key exposed",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "\\bpk_(live|test)_[0-9a-zA-Z]{10,}\\b",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_mapbox_token",
          "name": "Mapbox token exposed",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "\\bpk\\.[0-9a-zA-Z]{20,}\\b",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_google_api_key",
          "name": "Google API key pattern",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "\\bAIza[0-9A-Za-z\\-_]{35}\\b",
                    "i"
                  ]
                }
              ]
            }
          }
        }
      ]
    },
    {
      "id": "recon_api_docs_specs",
      "type": "passive",
      "name": "Passive Recon: API Docs & Specs Exposure",
      "metadata": {
        "description": "Detects exposure of API documentation, specs, and interactive consoles observed in traffic.",
        "recommendation": "<ul><li>Restrict API documentation endpoints to authenticated users where appropriate.</li><li>Disable interactive consoles in production or protect them with strong auth.</li></ul>",
        "links": {
          "OWASP API Security": "https://owasp.org/www-project-api-security/",
          "OWASP": "https://owasp.org/www-project-api-security/",
          "CWE": "https://cwe.mitre.org/data/definitions/200.html"
        },
        "severity": "info",
        "unique": true,
        "category": "sensitive_data",
        "owasp": ["A05:2021 - Security Misconfiguration"],
        "cwe": ["CWE-200"],
        "tags": ["dast", "recon", "passive", "api", "docs"],
        "vulnId": "info_disclosure"
      },
      "attacks": [
        {
          "id": "recon_swagger_ui",
          "name": "Swagger UI detected",
          "validation": {
            "rule": {
              "or": [
                {
                  "regex": [
                    {
                      "var": "original.request.url"
                    },
                    "/swagger-ui(\\b|/|$)",
                    "i"
                  ]
                },
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "Swagger UI|swagger-ui",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_openapi_spec",
          "name": "OpenAPI spec detected",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "\\\"openapi\\\"\\s*:\\s*\\\"3\\.",
                    "i"
                  ]
                },
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "\\\"paths\\\"\\s*:\\s*\\{",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_api_docs_routes",
          "name": "API docs endpoint observed",
          "validation": {
            "rule": {
              "or": [
                {
                  "regex": [
                    {
                      "var": "original.request.url"
                    },
                    "/(api-docs|v2/api-docs|openapi(\\.json)?|swagger(\\.json)?)\\b",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_graphql_endpoint",
          "name": "GraphQL endpoint observed",
          "validation": {
            "rule": {
              "or": [
                {
                  "regex": [
                    {
                      "var": "original.request.url"
                    },
                    "/graphql\\b",
                    "i"
                  ]
                },
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "\\\"query\\\"\\s*:\\s*\\\"",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_graphiql_console",
          "name": "GraphiQL / GraphQL Playground detected",
          "validation": {
            "rule": {
              "or": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "GraphiQL|graphql-playground|Apollo Client Devtools",
                    "i"
                  ]
                }
              ]
            }
          }
        }
      ]
    },
    {
      "id": "recon_well_known_metadata",
      "type": "passive",
      "name": "Passive Recon: .well-known & Metadata Files",
      "metadata": {
        "description": "Flags security-relevant well-known resources and metadata files when they appear in observed traffic.",
        "recommendation": "<ul><li>Ensure well-known endpoints do not leak internal configuration or secrets.</li><li>Review metadata contents and limit exposure where needed.</li></ul>",
        "links": {
          "RFC 8615": "https://www.rfc-editor.org/rfc/rfc8615",
          "security.txt": "https://securitytxt.org/",
          "OWASP": "https://cheatsheetseries.owasp.org/cheatsheets/Information_Leakage_Cheat_Sheet.html",
          "CWE": "https://cwe.mitre.org/data/definitions/200.html"
        },
        "severity": "info",
        "unique": true,
        "category": "sensitive_data",
        "owasp": ["A05:2021 - Security Misconfiguration"],
        "cwe": ["CWE-200"],
        "tags": ["dast", "recon", "passive", "discovery"],
        "vulnId": "info_disclosure"
      },
      "attacks": [
        {
          "id": "recon_security_txt",
          "name": "security.txt observed",
          "validation": {
            "rule": {
              "or": [
                {
                  "regex": [
                    {
                      "var": "original.request.url"
                    },
                    "/\\.well-known/security\\.txt(\\?|$)",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_oidc_well_known",
          "name": "OIDC well-known configuration observed",
          "validation": {
            "rule": {
              "or": [
                {
                  "regex": [
                    {
                      "var": "original.request.url"
                    },
                    "/\\.well-known/openid-configuration(\\?|$)",
                    "i"
                  ]
                },
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "\\\"issuer\\\"\\s*:\\s*\\\"https?://",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_assetlinks",
          "name": "Android assetlinks.json observed",
          "validation": {
            "rule": {
              "or": [
                {
                  "regex": [
                    {
                      "var": "original.request.url"
                    },
                    "/\\.well-known/assetlinks\\.json(\\?|$)",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_apple_association",
          "name": "Apple app-site-association observed",
          "validation": {
            "rule": {
              "or": [
                {
                  "regex": [
                    {
                      "var": "original.request.url"
                    },
                    "/(\\.well-known/)?apple-app-site-association(\\?|$)",
                    "i"
                  ]
                }
              ]
            }
          }
        }
      ]
    },
    {
      "id": "recon_tokens_in_url",
      "type": "passive",
      "name": "Passive Recon: Tokens & Secrets in URLs",
      "metadata": {
        "description": "Detects access tokens, JWTs, and API keys present in URLs or query strings observed in traffic.",
        "recommendation": "<ul><li>Avoid placing secrets in URLs. Use Authorization headers or secure cookies.</li><li>Rotate exposed tokens and ensure logs/analytics do not persist sensitive URLs.</li></ul>",
        "links": {
          "CWE-598": "https://cwe.mitre.org/data/definitions/598.html",
          "OWASP": "https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#session-id-in-url",
          "CWE": "https://cwe.mitre.org/data/definitions/598.html"
        },
        "severity": "medium",
        "unique": true,
        "category": "sensitive_data",
        "owasp": [
          "A02:2025 - Cryptographic Failures",
          "A07:2021 - Identification and Authentication Failures"
        ],
        "cwe": ["CWE-598", "CWE-200"],
        "tags": ["dast", "recon", "passive", "tokens"],
        "vulnId": "token_leak"
      },
      "attacks": [
        {
          "id": "recon_access_token_param",
          "name": "access_token/id_token in URL",
          "validation": {
            "rule": {
              "or": [
                {
                  "regex": [
                    {
                      "var": "original.request.url"
                    },
                    "[\\?&](access_token|id_token)=([^&#]{8,})",
                    "i"
                  ]
                },
                {
                  "or": [
                    {
                      "regex": [
                        {
                          "var": "original.request.queryParams"
                        },
                        "\\\"(access_token|id_token)\\\"\\s*:\\s*\\\"[^\\\"]{8,}\\\"",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.params"
                        },
                        "\\\"(access_token|id_token)\\\"\\s*:\\s*\\\"[^\\\"]{8,}\\\"",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.text"
                        },
                        "\\\"(access_token|id_token)\\\"\\s*:\\s*\\\"[^\\\"]{8,}\\\"",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.json"
                        },
                        "\\\"(access_token|id_token)\\\"\\s*:\\s*\\\"[^\\\"]{8,}\\\"",
                        "i"
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_jwt_like_in_url",
          "name": "JWT-like value in URL",
          "validation": {
            "rule": {
              "or": [
                {
                  "regex": [
                    {
                      "var": "original.request.url"
                    },
                    "[\\?&](token|jwt)=([A-Za-z0-9\\-_]+\\.[A-Za-z0-9\\-_]+\\.[A-Za-z0-9\\-_]+)",
                    "i"
                  ]
                },
                {
                  "regex": [
                    {
                      "var": "original.request.url"
                    },
                    "(?<!//)[/?#&=]([A-Za-z0-9\\-_]{10,}\\.[A-Za-z0-9\\-_]{10,}\\.[A-Za-z0-9\\-_]{10,})",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_api_key_param",
          "name": "api_key/key in URL",
          "validation": {
            "rule": {
              "or": [
                {
                  "regex": [
                    {
                      "var": "original.request.url"
                    },
                    "[\\?&](api[_-]?key|key)=([^&#]{8,})",
                    "i"
                  ]
                },
                {
                  "or": [
                    {
                      "regex": [
                        {
                          "var": "original.request.queryParams"
                        },
                        "\\\"(api[_-]?key|key)\\\"\\s*:\\s*\\\"[^\\\"]{8,}\\\"",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.params"
                        },
                        "\\\"(api[_-]?key|key)\\\"\\s*:\\s*\\\"[^\\\"]{8,}\\\"",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.text"
                        },
                        "\\\"(api[_-]?key|key)\\\"\\s*:\\s*\\\"[^\\\"]{8,}\\\"",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.json"
                        },
                        "\\\"(api[_-]?key|key)\\\"\\s*:\\s*\\\"[^\\\"]{8,}\\\"",
                        "i"
                      ]
                    }
                  ]
                }
              ]
            }
          }
        }
      ]
    },
    {
      "id": "recon_parameter_leads",
      "type": "passive",
      "name": "Passive Recon: High-Risk Parameter Names",
      "metadata": {
        "description": "Flags request parameters and JSON keys commonly associated with high-impact findings (open redirect, SSRF, IDOR, file/path traversal).",
        "recommendation": "<ul><li>Review identified parameters for input validation and strong authorization checks.</li><li>For redirect parameters, enforce allowlists and avoid open redirects.</li><li>For URL fetch/webhook parameters, enforce strict allowlists and block internal IP ranges.</li></ul>",
        "links": {
          "PortSwigger - SSRF": "https://portswigger.net/web-security/ssrf",
          "PortSwigger - IDOR": "https://portswigger.net/web-security/access-control/idor",
          "OWASP": "https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html",
          "CWE": "https://cwe.mitre.org/data/definitions/200.html"
        },
        "severity": "info",
        "unique": true,
        "category": "sensitive_data",
        "owasp": ["A01:2025 - Broken Access Control", "A03:2025 - Injection"],
        "cwe": ["CWE-639", "CWE-601", "CWE-918", "CWE-22"],
        "tags": ["dast", "recon", "passive", "params"],
        "vulnId": "info_disclosure"
      },
      "attacks": [
        {
          "id": "recon_param_open_redirect",
          "name": "Open redirect candidate parameter",
          "validation": {
            "rule": {
              "or": [
                {
                  "or": [
                    {
                      "regex": [
                        {
                          "var": "original.request.queryParams"
                        },
                        "(^|[?&]|\\\"|\\b)(next|return|redirect|redirect_uri|continue|url|dest|destination|callback|to)=",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.params"
                        },
                        "(^|[?&]|\\\"|\\b)(next|return|redirect|redirect_uri|continue|url|dest|destination|callback|to)=",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.text"
                        },
                        "(^|[?&]|\\\"|\\b)(next|return|redirect|redirect_uri|continue|url|dest|destination|callback|to)=",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.json"
                        },
                        "(^|[?&]|\\\"|\\b)(next|return|redirect|redirect_uri|continue|url|dest|destination|callback|to)=",
                        "i"
                      ]
                    }
                  ]
                },
                {
                  "or": [
                    {
                      "regex": [
                        {
                          "var": "original.request.queryParams"
                        },
                        "\\\"(next|return|redirect|redirectUri|continue|url|dest|destination|callback|to)\\\"\\s*:",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.params"
                        },
                        "\\\"(next|return|redirect|redirectUri|continue|url|dest|destination|callback|to)\\\"\\s*:",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.text"
                        },
                        "\\\"(next|return|redirect|redirectUri|continue|url|dest|destination|callback|to)\\\"\\s*:",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.json"
                        },
                        "\\\"(next|return|redirect|redirectUri|continue|url|dest|destination|callback|to)\\\"\\s*:",
                        "i"
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_param_ssrf",
          "name": "SSRF / webhook URL candidate parameter",
          "validation": {
            "rule": {
              "or": [
                {
                  "or": [
                    {
                      "regex": [
                        {
                          "var": "original.request.queryParams"
                        },
                        "(^|[?&]|\\\"|\\b)(url|uri|endpoint|host|domain|proxy|webhook|callback_url|image_url|avatar_url|fetch|target)=",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.params"
                        },
                        "(^|[?&]|\\\"|\\b)(url|uri|endpoint|host|domain|proxy|webhook|callback_url|image_url|avatar_url|fetch|target)=",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.text"
                        },
                        "(^|[?&]|\\\"|\\b)(url|uri|endpoint|host|domain|proxy|webhook|callback_url|image_url|avatar_url|fetch|target)=",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.json"
                        },
                        "(^|[?&]|\\\"|\\b)(url|uri|endpoint|host|domain|proxy|webhook|callback_url|image_url|avatar_url|fetch|target)=",
                        "i"
                      ]
                    }
                  ]
                },
                {
                  "or": [
                    {
                      "regex": [
                        {
                          "var": "original.request.queryParams"
                        },
                        "\\\"(url|uri|endpoint|host|domain|proxy|webhook|callbackUrl|imageUrl|avatarUrl|fetch|target)\\\"\\s*:",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.params"
                        },
                        "\\\"(url|uri|endpoint|host|domain|proxy|webhook|callbackUrl|imageUrl|avatarUrl|fetch|target)\\\"\\s*:",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.text"
                        },
                        "\\\"(url|uri|endpoint|host|domain|proxy|webhook|callbackUrl|imageUrl|avatarUrl|fetch|target)\\\"\\s*:",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.json"
                        },
                        "\\\"(url|uri|endpoint|host|domain|proxy|webhook|callbackUrl|imageUrl|avatarUrl|fetch|target)\\\"\\s*:",
                        "i"
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_param_file_path",
          "name": "File/path candidate parameter",
          "validation": {
            "rule": {
              "or": [
                {
                  "or": [
                    {
                      "regex": [
                        {
                          "var": "original.request.queryParams"
                        },
                        "(^|[?&]|\\\"|\\b)(file|path|dir|folder|template|view|include|download|export|import)=",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.params"
                        },
                        "(^|[?&]|\\\"|\\b)(file|path|dir|folder|template|view|include|download|export|import)=",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.text"
                        },
                        "(^|[?&]|\\\"|\\b)(file|path|dir|folder|template|view|include|download|export|import)=",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.json"
                        },
                        "(^|[?&]|\\\"|\\b)(file|path|dir|folder|template|view|include|download|export|import)=",
                        "i"
                      ]
                    }
                  ]
                },
                {
                  "or": [
                    {
                      "regex": [
                        {
                          "var": "original.request.queryParams"
                        },
                        "\\\"(file|path|dir|folder|template|view|include|download|export|import)\\\"\\s*:",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.params"
                        },
                        "\\\"(file|path|dir|folder|template|view|include|download|export|import)\\\"\\s*:",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.text"
                        },
                        "\\\"(file|path|dir|folder|template|view|include|download|export|import)\\\"\\s*:",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.json"
                        },
                        "\\\"(file|path|dir|folder|template|view|include|download|export|import)\\\"\\s*:",
                        "i"
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_param_idor",
          "name": "IDOR candidate parameter",
          "validation": {
            "rule": {
              "or": [
                {
                  "or": [
                    {
                      "regex": [
                        {
                          "var": "original.request.queryParams"
                        },
                        "(^|[?&]|\\\"|\\b)(id|userId|accountId|orgId|tenantId|projectId|teamId|invoiceId|orderId|customerId)=",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.params"
                        },
                        "(^|[?&]|\\\"|\\b)(id|userId|accountId|orgId|tenantId|projectId|teamId|invoiceId|orderId|customerId)=",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.text"
                        },
                        "(^|[?&]|\\\"|\\b)(id|userId|accountId|orgId|tenantId|projectId|teamId|invoiceId|orderId|customerId)=",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.json"
                        },
                        "(^|[?&]|\\\"|\\b)(id|userId|accountId|orgId|tenantId|projectId|teamId|invoiceId|orderId|customerId)=",
                        "i"
                      ]
                    }
                  ]
                },
                {
                  "or": [
                    {
                      "regex": [
                        {
                          "var": "original.request.queryParams"
                        },
                        "\\\"(id|userId|accountId|orgId|tenantId|projectId|teamId|invoiceId|orderId|customerId|ownerId)\\\"\\s*:",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.params"
                        },
                        "\\\"(id|userId|accountId|orgId|tenantId|projectId|teamId|invoiceId|orderId|customerId|ownerId)\\\"\\s*:",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.text"
                        },
                        "\\\"(id|userId|accountId|orgId|tenantId|projectId|teamId|invoiceId|orderId|customerId|ownerId)\\\"\\s*:",
                        "i"
                      ]
                    },
                    {
                      "regex": [
                        {
                          "var": "original.request.body.json"
                        },
                        "\\\"(id|userId|accountId|orgId|tenantId|projectId|teamId|invoiceId|orderId|customerId|ownerId)\\\"\\s*:",
                        "i"
                      ]
                    }
                  ]
                }
              ]
            }
          }
        }
      ]
    },
    {
      "id": "recon_internal_hosts_env_hints",
      "type": "passive",
      "name": "Passive Recon: Internal Hosts & Environment Hints",
      "metadata": {
        "description": "Detects internal hostnames/IPs and environment hints (staging/dev/local) disclosed in observed responses.",
        "recommendation": "<ul><li>Remove internal hostnames/IPs from client responses.</li><li>Ensure staging/dev configuration is not exposed to production clients.</li></ul>",
        "links": {
          "CWE-200": "https://cwe.mitre.org/data/definitions/200.html",
          "OWASP": "https://cheatsheetseries.owasp.org/cheatsheets/Information_Leakage_Cheat_Sheet.html",
          "CWE": "https://cwe.mitre.org/data/definitions/200.html"
        },
        "severity": "low",
        "unique": true,
        "category": "sensitive_data",
        "owasp": ["A05:2021 - Security Misconfiguration"],
        "cwe": ["CWE-200"],
        "tags": ["dast", "recon", "passive", "infoleak"],
        "vulnId": "info_disclosure"
      },
      "attacks": [
        {
          "id": "recon_internal_ip_leak",
          "name": "Internal IP address leaked in response",
          "validation": {
            "rule": {
              "or": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "\\b(10\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}|192\\.168\\.\\d{1,3}\\.\\d{1,3}|172\\.(1[6-9]|2\\d|3[0-1])\\.\\d{1,3}\\.\\d{1,3})\\b",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_localhost_leak",
          "name": "localhost/127.0.0.1 referenced in response",
          "validation": {
            "rule": {
              "or": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "\\blocalhost\\b|127\\.0\\.0\\.1",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_env_hints",
          "name": "Environment hints (dev/staging/test) in response",
          "validation": {
            "rule": {
              "or": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "\\b(staging|stage|dev|development|test|sandbox|uat)\\b",
                    "i"
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_cloud_metadata_hints",
          "name": "Cloud metadata IP referenced",
          "validation": {
            "rule": {
              "or": [
                {
                  "regex": [
                    {
                      "var": "original.response.body"
                    },
                    "\\b169\\.254\\.169\\.254\\b|metadata\\.google\\.internal",
                    "i"
                  ]
                }
              ]
            }
          }
        }
      ]
    },
    {
      "id": "recon_cors_posture",
      "type": "passive",
      "name": "Passive Recon: CORS Posture Indicators",
      "metadata": {
        "description": "Adds passive CORS posture checks: missing Vary: Origin for dynamic ACAO, and permissive allowed headers/methods.",
        "recommendation": "<ul><li>Include <code>Vary: Origin</code> for dynamic CORS responses.</li><li>Restrict allowed methods/headers to what is necessary.</li></ul>",
        "links": {
          "MDN - CORS": "https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS",
          "OWASP": "https://cheatsheetseries.owasp.org/cheatsheets/CORS_OriginHeaderScrutiny_Cheat_Sheet.html",
          "CWE": "https://cwe.mitre.org/data/definitions/942.html"
        },
        "severity": "low",
        "unique": true,
        "category": "security_misconfiguration",
        "owasp": ["A05:2021 - Security Misconfiguration"],
        "cwe": ["CWE-942", "CWE-200"],
        "tags": ["dast", "recon", "passive", "cors"],
        "vulnId": "insecure_cors"
      },
      "attacks": [
        {
          "id": "recon_cors_missing_vary_origin",
          "name": "Dynamic ACAO without Vary: Origin",
          "validation": {
            "rule": {
              "and": [
                {
                  "some": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "and": [
                        {
                          "regex": [
                            {
                              "var": "name"
                            },
                            "^access-control-allow-origin$",
                            "i"
                          ]
                        },
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            "^(?!\\s*\\*\\s*$).+",
                            "i"
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "none": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "and": [
                        {
                          "regex": [
                            {
                              "var": "name"
                            },
                            "^vary$",
                            "i"
                          ]
                        },
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            "\\borigin\\b",
                            "i"
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_cors_permissive_methods",
          "name": "CORS allows broad methods",
          "validation": {
            "rule": {
              "and": [
                {
                  "some": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "and": [
                        {
                          "regex": [
                            {
                              "var": "name"
                            },
                            "^access-control-allow-methods$",
                            "i"
                          ]
                        },
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            "\\bPUT\\b|\\bDELETE\\b|\\bPATCH\\b",
                            "i"
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_cors_permissive_headers",
          "name": "CORS allows broad headers",
          "validation": {
            "rule": {
              "and": [
                {
                  "some": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "and": [
                        {
                          "regex": [
                            {
                              "var": "name"
                            },
                            "^access-control-allow-headers$",
                            "i"
                          ]
                        },
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            "\\bAuthorization\\b|\\bX-Api-Key\\b|\\bX-Requested-With\\b",
                            "i"
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        }
      ]
    },
    {
      "id": "recon_cache_privacy",
      "type": "passive",
      "name": "Passive Recon: Cache & Privacy Posture",
      "metadata": {
        "description": "Flags potentially risky cacheability for responses that appear user-specific and missing cache partitioning indicators.",
        "recommendation": "<ul><li>Mark authenticated or user-specific responses as <code>Cache-Control: no-store</code>.</li><li>Use appropriate <code>Vary</code> headers for responses that change by user or origin.</li></ul>",
        "links": {
          "OWASP - Secure Headers": "https://owasp.org/www-project-secure-headers/",
          "OWASP": "https://owasp.org/www-project-secure-headers/",
          "CWE": "https://cwe.mitre.org/data/definitions/525.html"
        },
        "severity": "low",
        "unique": true,
        "category": "security_misconfiguration",
        "owasp": ["A05:2021 - Security Misconfiguration"],
        "cwe": ["CWE-525", "CWE-200"],
        "tags": ["dast", "recon", "passive", "cache"],
        "vulnId": "security_headers"
      },
      "attacks": [
        {
          "id": "recon_cache_public_with_set_cookie",
          "name": "Cache-Control public/max-age with Set-Cookie",
          "validation": {
            "rule": {
              "and": [
                {
                  "some": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "and": [
                        {
                          "regex": [
                            {
                              "var": "name"
                            },
                            "^set-cookie$",
                            "i"
                          ]
                        },
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            ".+",
                            "i"
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "some": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "and": [
                        {
                          "regex": [
                            {
                              "var": "name"
                            },
                            "^cache-control$",
                            "i"
                          ]
                        },
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            "\\b(public|max-age\\s*=\\s*\\d+)\\b",
                            "i"
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "none": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "and": [
                        {
                          "regex": [
                            {
                              "var": "name"
                            },
                            "^cache-control$",
                            "i"
                          ]
                        },
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            "\\bno-store\\b",
                            "i"
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_missing_referrer_policy",
          "name": "Missing Referrer-Policy",
          "validation": {
            "rule": {
              "and": [
                {
                  "some": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "and": [
                        {
                          "regex": [
                            {
                              "var": "name"
                            },
                            "^content-type$",
                            "i"
                          ]
                        },
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            "text/html",
                            "i"
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "none": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "regex": [
                        {
                          "var": "name"
                        },
                        "^referrer\\-policy$",
                        "i"
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_referrer_policy_unsafe",
          "name": "Unsafe Referrer-Policy",
          "validation": {
            "rule": {
              "and": [
                {
                  "some": [
                    {
                      "var": "original.response.headers"
                    },
                    {
                      "and": [
                        {
                          "regex": [
                            {
                              "var": "name"
                            },
                            "^referrer-policy$",
                            "i"
                          ]
                        },
                        {
                          "regex": [
                            {
                              "var": "value"
                            },
                            "unsafe-url|no-referrer-when-downgrade",
                            "i"
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        }
      ]
    },
    {
      "id": "recon_interesting_endpoints",
      "type": "passive",
      "name": "Passive Recon: Interesting Endpoint Patterns",
      "metadata": {
        "description": "Flags high-value endpoint patterns observed in traffic (admin panels, debug endpoints, consoles, and backup/config file paths).",
        "recommendation": "<ul><li>Restrict administrative and debug endpoints behind strong authentication and network controls.</li><li>Remove unused consoles and do not deploy backup/config files to production.</li></ul>",
        "links": {
          "OWASP - Attack Surface Analysis": "https://owasp.org/www-project-attack-surface-analysis/",
          "OWASP": "https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html",
          "CWE": "https://cwe.mitre.org/data/definitions/200.html"
        },
        "severity": "info",
        "unique": true,
        "category": "sensitive_data",
        "owasp": ["A05:2021 - Security Misconfiguration"],
        "cwe": ["CWE-200"],
        "tags": ["dast", "recon", "passive", "endpoints"],
        "vulnId": "info_disclosure"
      },
      "attacks": [
        {
          "id": "recon_admin_paths",
          "name": "Admin/management path observed",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.request.url"
                    },
                    "/(admin|administrator|manage|management|console|cpanel|superadmin)(/|\\b)",
                    "i"
                  ]
                },
                {
                  "in": [
                    {
                      "var": "original.response.statusCode"
                    },
                    [200, 204, 301, 302, 401, 403]
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_debug_paths",
          "name": "Debug/diagnostic path observed",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.request.url"
                    },
                    "/(debug|diagnostics|trace|health|metrics|status)(/|\\b)",
                    "i"
                  ]
                },
                {
                  "in": [
                    {
                      "var": "original.response.statusCode"
                    },
                    [200, 204, 301, 302, 401, 403]
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_spring_actuator",
          "name": "Spring Boot actuator endpoint observed",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.request.url"
                    },
                    "/actuator(/|\\b)",
                    "i"
                  ]
                },
                {
                  "in": [
                    {
                      "var": "original.response.statusCode"
                    },
                    [200, 204, 301, 302, 401, 403]
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_swagger_paths",
          "name": "Swagger/OpenAPI path observed",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.request.url"
                    },
                    "/(swagger|openapi|api-docs)(/|\\b)",
                    "i"
                  ]
                },
                {
                  "in": [
                    {
                      "var": "original.response.statusCode"
                    },
                    [200, 204, 301, 302, 401, 403]
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_graphql_paths",
          "name": "GraphQL path observed",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.request.url"
                    },
                    "/graphql(\\b|/)",
                    "i"
                  ]
                },
                {
                  "in": [
                    {
                      "var": "original.response.statusCode"
                    },
                    [200, 204, 301, 302, 401, 403]
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_backup_files",
          "name": "Potential backup file observed",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.request.url"
                    },
                    "\\.(bak|old|backup|tmp|swp)(\\?|$)",
                    "i"
                  ]
                },
                {
                  "in": [
                    {
                      "var": "original.response.statusCode"
                    },
                    [200, 204, 301, 302, 401, 403]
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_dotenv_files",
          "name": "Environment/config file observed",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.request.url"
                    },
                    "/(\\.env|\\.env\\.local|config\\.json|settings\\.json)(\\?|$)",
                    "i"
                  ]
                },
                {
                  "in": [
                    {
                      "var": "original.response.statusCode"
                    },
                    [200, 204, 301, 302, 401, 403]
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_git_exposure",
          "name": "Potential .git exposure path observed",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.request.url"
                    },
                    "/\\.git(/|\\b)",
                    "i"
                  ]
                },
                {
                  "in": [
                    {
                      "var": "original.response.statusCode"
                    },
                    [200, 204, 301, 302, 401, 403]
                  ]
                }
              ]
            }
          }
        },
        {
          "id": "recon_phpinfo",
          "name": "phpinfo endpoint observed",
          "validation": {
            "rule": {
              "and": [
                {
                  "regex": [
                    {
                      "var": "original.request.url"
                    },
                    "/phpinfo(\\.php)?(\\b|/)",
                    "i"
                  ]
                },
                {
                  "in": [
                    {
                      "var": "original.response.statusCode"
                    },
                    [200, 204, 301, 302, 401, 403]
                  ]
                }
              ]
            }
          }
        }
      ]
    }
  ]
}
